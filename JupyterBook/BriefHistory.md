# <font color="maroon"> Background </font>

Detectors came about after an extensive analysis of backbone (Hâ€“N) motion in HET-s(218-289) fibrils using [model-free](https://doi.org/10.1021/ja00381a009) analysis ([paper](https://link.springer.com/article/10.1007/s10858-016-0047-8)). After what had been quite a lot of work, I had to admit to myself that I had very little idea what the parameters actually meant. Regions of the protein expected to be more flexible had apparently higher ampitude motion on some timescales, but slower motion on other timescales. We didn't have a physical model available to try to explain what seemed like a contradiction, so we started running MD simulations to see if that would help. It did not, at first. Model-free parameters from MD were orders of magnitudes different in MD than in NMR. However, after initially disregarding the MD, we later realized that we could calculate relaxation rate constants directly from MD, and found them to be in much better agreement than the model-free parameters themselves.

So, model-free applied to NMR returns very different answers than when the same model is applied to MD. The *why*: the 1-3 correlation times used in the model-free model is fewer than the real number of correlation times, yielding unexpected [biasing](https://doi.org/10.1002/anie.201707316) that depends explicitily on the data source. So, modeling 3 correlation times with MD gives a different answer than modeling 3 correlation times using NMR, even if the motions are identical between experiment and simulation. Then, it becomes very difficult to verify the quality of the MD, rendering it somewhat useless for interpreting NMR dynamics analyses.

Thus, we started looking around for other methods to analyze the NMR that did not explicitely assume the number of correlation times. [Spectral density mapping](https://doi.org/10.1016/0022-2364(92)90135-T) and an approach by [David LeMaster](https://doi.org/10.1007/BF00197636) are examples of such approaches, but are generally applied to one field solution-state NMR data, whereas we had multi-field solid-state NMR data. [IMPACT](https://doi.org/10.1016/j.bpj.2015.06.069) met the multifield requirement, but was also a solution method and posed a number of issues when applied to solid-state NMR data sets. However, eventually 'detectors' were born, after studying the reasons that IMPACT didn't work for solid-state NMR, plus a bit of luck after reading a Wikipedia article on [color perception](https://en.wikipedia.org/wiki/Color_vision) and realizing that there were some similarities in the two problems.

A [detector analysis](https://aip.scitation.org/doi/abs/10.1063/1.5013316), then, returns a series of detector responses, $\rho_n^{(\theta,S)}$. Each detector response characterizes the amount of motion in a given correlation time window, defined by the detector's sensitivity, $\rho_n(z)$, where $z=log_{10}(\tau_c/1\cdot\mathrm {s})$. If the motion is described by a distribution of correlation times, $(1-S^2)\theta(z)$, where $S^2$ is the usual NMR order parameter, $(1-S^2)$ is the total decay of the correlation function, and $\theta(z)$ describes how that decay is distributed as a function of correlation time, then the detector responses are given by

$$
\begin{equation}
\rho_n^{(\theta,S)}=(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)\rho_n(z)dz}
\end{equation}
$$

This analysis, then, can be used to treat systems with an arbitrary number of correlation times, assuming only that the \[rank-2 tensor\]correlation function is a sum of decaying exponentials. 

The challenge since then has been to explain what exactly these parameters mean. Without some idea of the model of motion, the parameters yield their definition reliably, but a really physical interpretation is difficult. Therefore, pyDIFRATE smoothly integrates multiple methods, especially NMR and MD simulation, to try to interpret these parameters, and understand the underlying nature of the dynamics at a higher level of detail than previously possible based on experiment or simulation alone. Multiple computational methods have been integrated with a fast, easy to use software that also includes data management and 2D and 3D visualization approaches.

**So, is it 'detectors' or DIFRATE?**

Detectors is the name of the method. DIFRATE is the name of the original MATLAB software [package](http://difrate.sourceforge.io/), and pyDIFRATE is the Python implementation (although the pyDIFRATE package on GitHub is superceded by [pyDR](http://github.com/alsinmr/pyDR)). DIFRATE stands for DIstortion Free Relaxation Analysis TEchnique, and one essentially end up taking sums and differences of relaxation rate constants, so it was complete with a double meaning. However, being distortion *free* was too big a claim to be made in a peer-reviewed paper, so only the software and not the method ended up being named DIFRATE (I would maintain that it is distortion free as long as the correlation function is monoexponential, although I would not make this claim about solution-state NMR data).

**Major contributors**
Aside from myself, Beat Meier and Matthias Ernst helped clarify a lot of the important ideas for detector analysis and explain its necessity, and Fabien Ferrage was critical in repurposing for solution-state NMR. Daniel Huster has been a champion for pushing for its application beyond model proteins and looking at more biologically relevant systems. Kai Zumpfe has contributed significantly to the software itself. 
