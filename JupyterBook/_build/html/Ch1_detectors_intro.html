
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 1: A brief introduction to detectors &#8212; pyDIFRATE Tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ch1_detectors_intro';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 2: Detector Optimization" href="Ch2_detector_opt.html" />
    <link rel="prev" title="References" href="References.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="pyDIFRATE Tutorial - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="pyDIFRATE Tutorial - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the pyDIFRATE tutorial
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html"><font color="maroon">Getting Started</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="BriefHistory.html"><font color="maroon"> Background </font></a></li>
<li class="toctree-l1"><a class="reference internal" href="References.html"><font color="maroon"> References </font></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><font color="maroon"> Chapter 1: A brief introduction to detectors </font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch2_detector_opt.html"><font color="maroon">Chapter 2: Detector Optimization</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch3_basic_NMR.html"><font color="maroon">Chapter 3: A Basic NMR Analysis</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch4_ComparingAnalyses.html"><font color="maroon">Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch5_MDvsNMR.html"><font color="maroon">Chapter 5: Comparing MD and NMR Results</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch6_pyDRstruct.html"><font color="maroon">Chapter 6: Anatomy of pyDIFRATE</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch7_CCana.html"><font color="maroon">Chapter 7: Cross-Correlated Dynamics via iRED</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch8_ROMANCE_backbone.html"><font color="maroon">Chapter 8: ROMANCE Analysis of Backbone Motion</font></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Templates</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tpl_blank.html"><font color="maroon">Template: pyDR Setup</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tpl_basicNMR.html"><font color="maroon">Template: Basic NMR</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tpl_SolnNMR.html"><font color="maroon">Template: Solution-State NMR</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tpl_CCana.html"><font color="maroon">Template: Cross-Correlated Dynamics via iRED</font></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/alsinmr/pyDR_tutorial" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/alsinmr/pyDR_tutorial/issues/new?title=Issue%20on%20page%20%2FCh1_detectors_intro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Ch1_detectors_intro.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><font color="maroon"> Chapter 1: A brief introduction to detectors </font></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#models-for-decaying-correlation-functions">Models for decaying correlation functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-angular-correlation-function-for-nmr">The angular correlation function for NMR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-dynamics-data">Fitting dynamics data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-detector-theory">Basic detector theory</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-1-a-brief-introduction-to-detectors">
<h1><font color="maroon"> Chapter 1: A brief introduction to detectors </font><a class="headerlink" href="#chapter-1-a-brief-introduction-to-detectors" title="Link to this heading">#</a></h1>
<p><a href="https://githubtocolab.com/alsinmr/pyDR_tutorial/blob/main/ColabNotebooks/Ch1_detectors_intro.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg"></a></p>
<section id="models-for-decaying-correlation-functions">
<h2>Models for decaying correlation functions<a class="headerlink" href="#models-for-decaying-correlation-functions" title="Link to this heading">#</a></h2>
<p>Experimental and simulated dynamics information is often assumed to be described based on a time-correlation function, which relates the state of some parameter at an initial time to its value at a later time. The time-correlation is the <em>average</em> of that relationship. For example, for some parameter which varies with time, <span class="math notranslate nohighlight">\(X(\tau)\)</span>, the simplest time-correlation function would be</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
C(t)=\langle X(\tau)\cdot X(t+\tau)\rangle_\tau
\end{equation}
\]</div>
<p>where the brackets (<span class="math notranslate nohighlight">\(\langle\rangle_\tau\)</span>) indicate an average over the initial time, <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
<p>Then, the time-correlation function usually decays in time, indicating that the value of <span class="math notranslate nohighlight">\(X(t+\tau)\)</span> eventually becomes uncorrelated with its value at some earlier time, <span class="math notranslate nohighlight">\(X(\tau)\)</span>. A simple model for this behavior is to assume the correlation function has the form</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
C(t)=\left(\langle X(t)^2\rangle_\tau-\langle X(t)\rangle_\tau^2\right)e^{-t/\tau_c}+\langle X(t)\rangle_\tau^2.
\end{equation}
\]</div>
<p>In this simple case, the correlation time, <span class="math notranslate nohighlight">\(\tau_c\)</span>, indicates how quickly the correlation decays. A shorter <span class="math notranslate nohighlight">\(\tau_c\)</span> indicates a faster motion, and a longer <span class="math notranslate nohighlight">\(\tau_c\)</span> indicates a slower motion. <span class="math notranslate nohighlight">\(\langle X(\tau)\rangle_\tau\)</span> is simply the average of the parameter <span class="math notranslate nohighlight">\(X(\tau)\)</span>, and (<span class="math notranslate nohighlight">\(\langle X(t)^2\rangle_\tau-\langle X(t)\rangle_\tau^2\)</span>) is its variance (standard deviation squared)</p>
<p>It can be, however, that multiple motions affect the decorrelation, in which case the correlation function can be modeled more generally as</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
C(t)=\langle X(t)\rangle_\tau^2+\sum\limits_i{A_i\exp(-t/\tau_i)}
\end{equation}
\]</div>
<p>In this case, the <span class="math notranslate nohighlight">\(A_i\)</span> add up to the total variance (<span class="math notranslate nohighlight">\(\langle X(t)^2\rangle_\tau-\langle X(t)\rangle_\tau^2\)</span>), but each corresponds to a different correlation time, representing contributions from different motions with varying speeds. This expression suggests a number of discrete motions, but it is also possible to obtain a continuum of correlation times, in which case we would better represent the situation with a continuum of correlation times, yielding an integral:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
C(t)=\langle X(t)\rangle_\tau^2+\int\limits_{-\infty}^\infty{\theta(z)\exp(-t/(10^z\cdot1\mathrm{ s})dz}
\end{equation}
\]</div>
<p>In this representation, <span class="math notranslate nohighlight">\(z\)</span> is the log-correlation time (<span class="math notranslate nohighlight">\(z=\log_{10}(\tau_c/\mathrm{s})\)</span>), and <span class="math notranslate nohighlight">\(\theta(z)\)</span> is the distribution of correlation times as a function of the log-correlation time. <span class="math notranslate nohighlight">\(\theta(z)\)</span> must then integrate to the total variance.</p>
</section>
<section id="the-angular-correlation-function-for-nmr">
<h2>The angular correlation function for NMR<a class="headerlink" href="#the-angular-correlation-function-for-nmr" title="Link to this heading">#</a></h2>
<p>In NMR, a major source of relaxation is due to the stochastic reoriention of anisotropic interaction tensors, such as dipole couplings, chemical shift anisotropies (CSA), and quadrupole couplings. Then, we cannot use a strictly linear correlation function, but rather must use the rank-2 tensor correlation function (which can be constructed from a sum of linear correlation functions).</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
C(t)=\left\langle\frac{3\cos^2\beta_{\tau,t+\tau}-1}{2}\right\rangle_\tau
\end{equation}
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\beta_{\tau,t+\tau}\)</span> is the angle between the z-component of the relevant tensor at some time <span class="math notranslate nohighlight">\(\tau\)</span> and a later time, <span class="math notranslate nohighlight">\(t+\tau\)</span>. For example, for a one-bond dipole coupling, this is just the angle between the bond between the two times <span class="math notranslate nohighlight">\(\tau\)</span> and <span class="math notranslate nohighlight">\(t+\tau\)</span>.</p>
<p>Given the full correlation function, a given relaxation rate constant may be obtained by first calculating the spectral density function, <span class="math notranslate nohighlight">\(J(\omega)\)</span>, which is the Fourier transform of the correlation function</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
J(\omega)=\frac25\int\limits_0^\infty{C(t)\exp(-i\omega t)dt}.
\end{equation}
\]</div>
<p>Then, for example, <span class="math notranslate nohighlight">\(T_1\)</span> relaxation of a <span class="math notranslate nohighlight">\(^{13}\)</span>C nucleus due to a single bonded <span class="math notranslate nohighlight">\(^1\)</span>H and its CSA is given by</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
R_1=\left(\frac{\delta_\mathrm{HC}}{4}\right)^2(J(\omega_\mathrm{H}-\omega_\mathrm{C})+3J(\omega_\mathrm{C})+6J(\omega_\mathrm{H}+\omega_\mathrm{C}))+\frac13(\omega_\mathrm{C}\Delta\sigma)^2J(\omega_\mathrm{C})
\end{equation}
\]</div>
<p>In this equation, <span class="math notranslate nohighlight">\(R_1\)</span> is the longitudinal relaxation rate constant for <span class="math notranslate nohighlight">\(^{13}\)</span>C (<span class="math notranslate nohighlight">\(1/T_1=R_1\)</span>), with <span class="math notranslate nohighlight">\(\delta_\mathrm{HC}\)</span> being the anisotropy of the dipole coupling and <span class="math notranslate nohighlight">\(\Delta\sigma_\mathrm{C}\)</span> the width of the CSA in ppm. The <span class="math notranslate nohighlight">\(J(\omega)\)</span> are sampled at the <span class="math notranslate nohighlight">\(^1\)</span>H and <span class="math notranslate nohighlight">\(^{13}\)</span>C Larmor frequencies in addition to their sums and differences (given in radians/s).</p>
<p>In general, relaxation due to reorientational motion can be expressed as a sum over the spectral density sampled at various frequencies:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
R_\zeta=\sum\limits_i{a_iJ(\omega_i)}
\end{equation}.
\]</div>
<p>For the rank-2 tensor correlation function, we typically give the correlation function in terms of the order parameter squared (<span class="math notranslate nohighlight">\(S^2\)</span>), where the <span class="math notranslate nohighlight">\(A_i\)</span> must then sum to one (or <span class="math notranslate nohighlight">\(\theta(z)\)</span> integrates to 1):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
C(t)&amp;=&amp;S^2+(1-S^2)\sum\limits_i{A_i\exp(-t/\tau_i}) \\
&amp;=&amp;S^2+(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)\exp(-t/(10^z\cdot\mathrm{ s}))dz}
\end{eqnarray}
\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(S^2\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
S^2=\lim_{t\rightarrow\infty}C(t)
\end{equation}
\]</div>
</section>
<section id="fitting-dynamics-data">
<h2>Fitting dynamics data<a class="headerlink" href="#fitting-dynamics-data" title="Link to this heading">#</a></h2>
<p>Whether we have NMR data, or other dynamics data depending on some form of time-correlation function, we can, in principle, fit the experimental data based on some model of the correlation function. However, the challenge is, if we don’t know the model, how valuable are these fits? We’ll start by taking some example motion, characterized by 3 motions and calculate a few relaxation rate constants for those motions. We will then attempt to fit to a model, to show why fitting the correlation function to an explicit model can be problematic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SETUP pyDR</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;../..&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import various modules, including the pyDR module</span>
<span class="kn">import</span> <span class="nn">pyDR</span>   <span class="c1">#Import the pyDR software, which includes functions for calculating NMR relaxation rate constants</span>
<span class="kn">from</span> <span class="nn">pyDR.misc.tools</span> <span class="kn">import</span> <span class="n">linear_ex</span> <span class="c1">#Convenient tool for interpolating between data points</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#Lots of nice linear algebra tools</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1">#Plotting tools</span>

<span class="c1">#Zoomable plots with matplotlib notebook</span>
<span class="c1"># %matplotlib notebook</span>

<span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5</span><span class="p">,</span><span class="o">-</span><span class="mf">7.5</span><span class="p">]</span>  <span class="c1">#These are log-correlation times, corresponding to 10 ps, 1 ns, and 1 μs, respectively</span>
<span class="n">A</span><span class="o">=</span><span class="p">[</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.05</span><span class="p">,</span><span class="mf">.01</span><span class="p">]</span>  <span class="c1">#These are the corresponding amplitudes. The total amplitude of motion is 0.38 (S^2=0.62)</span>

<span class="n">nmr</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">NMR</span><span class="p">()</span>  <span class="c1">#This is a container for NMR experiments, which gives the relaxation rates as a function of z</span>
<span class="n">nmr</span><span class="o">.</span><span class="n">new_exper</span><span class="p">(</span><span class="n">Type</span><span class="o">=</span><span class="s1">&#39;R1&#39;</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="p">[</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">800</span><span class="p">],</span><span class="n">Nuc</span><span class="o">=</span><span class="s1">&#39;15N&#39;</span><span class="p">)</span> <span class="c1">#Add 3 experiments: 15N T1 at 400, 600, and 800 MHz</span>
<span class="c1">#We assume by default N15 coupled to a single proton (22.954 kHz = 2*11.477) and CSA of 113 ppm (z-component)</span>
<span class="n">nmr</span><span class="o">.</span><span class="n">new_exper</span><span class="p">(</span><span class="n">Type</span><span class="o">=</span><span class="s1">&#39;R1p&#39;</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span><span class="n">vr</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">v1</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">Nuc</span><span class="o">=</span><span class="s1">&#39;15N&#39;</span><span class="p">)</span> <span class="c1">#Add an R1p (MAS=60 kHz, spin-lock at 10 kHz)</span>
<span class="n">nmr</span><span class="o">.</span><span class="n">new_exper</span><span class="p">(</span><span class="n">Type</span><span class="o">=</span><span class="s1">&#39;S2&#39;</span><span class="p">)</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$R_1$(400 MHz)&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$R_1$(600 MHz)&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$R_1$(800 MHz)&#39;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s1">&#39;$R_{1\rho}$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$1-S^2$&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nmr</span><span class="o">.</span><span class="n">plot_Rz</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span> <span class="c1">#Plot the 9 relaxation rate constants (normalized to max of 1) vs tc</span>
<span class="n">_</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dfab2e36e26960b55c006ec1058fb5579c05b4ef562c858711ced63416393908.png" src="_images/dfab2e36e26960b55c006ec1058fb5579c05b4ef562c858711ced63416393908.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dfab2e36e26960b55c006ec1058fb5579c05b4ef562c858711ced63416393908.png" src="_images/dfab2e36e26960b55c006ec1058fb5579c05b4ef562c858711ced63416393908.png" />
</div>
</div>
<p>Now we can construct the relaxation rate constants for the seven experiments above, by simply summing over the three correlation times and amplitudes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nmr</span><span class="o">.</span><span class="n">rhoz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1">#Pre-allocate an array with 7 relaxation rates</span>
<span class="k">for</span> <span class="n">z0</span><span class="p">,</span><span class="n">A0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">):</span>    <span class="c1">#Iterate over all correlation times, amplitudes</span>
    <span class="n">R</span><span class="o">+=</span><span class="n">A0</span><span class="o">*</span><span class="n">linear_ex</span><span class="p">(</span><span class="n">nmr</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">nmr</span><span class="o">.</span><span class="n">rhoz</span><span class="p">,</span><span class="n">z0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)),</span><span class="n">R</span><span class="p">)</span>
<span class="c1">#Some figure cleanup/labeling</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R$ / s$^{-1}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1cbf8828bfd8d16d397e8e17a426e6d457c69ec93c0b8879f3b8726f029e9406.png" src="_images/1cbf8828bfd8d16d397e8e17a426e6d457c69ec93c0b8879f3b8726f029e9406.png" />
</div>
</div>
<p>Now, the question is, can we fit this data based on a model of the correlation function, and does that model have to match the original model. For demonstration purposes, we try both a model with two and with three correlation times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Function to calculate relaxation rate constants</span>
<span class="k">def</span> <span class="nf">calcR</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">nmr</span><span class="p">):</span>
    <span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nmr</span><span class="o">.</span><span class="n">rhoz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">z0</span><span class="p">,</span><span class="n">A0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">):</span>    <span class="c1">#Iterate over all correlation times, amplitudes</span>
        <span class="n">R</span><span class="o">+=</span><span class="n">A0</span><span class="o">*</span><span class="n">linear_ex</span><span class="p">(</span><span class="n">nmr</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">nmr</span><span class="o">.</span><span class="n">rhoz</span><span class="p">,</span><span class="n">z0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">R</span>

<span class="c1">#Function to calculate error of fit</span>
<span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span><span class="n">Af</span><span class="p">):</span>
    <span class="n">Ri</span><span class="o">=</span><span class="n">calcR</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">nmr</span><span class="p">)</span>
    <span class="n">Rc</span><span class="o">=</span><span class="n">calcR</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span><span class="n">Af</span><span class="p">,</span><span class="n">nmr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Ri</span><span class="o">-</span><span class="n">Rc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Function to use with nonlinear minimization algorithm (needs to have just one argument)</span>
<span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">zf</span><span class="o">=</span><span class="n">x</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Af</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span><span class="n">Af</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>First, we just try to fit with the original model, i.e. with a tri-exponential decay</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
C(t)=1-(A_0+A_1+A_2)+A_0\exp(-t/\tau_0)+A_1\exp(-t/\tau_1)+A_2\exp(-t/\tau_2)
\end{equation}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span><span class="o">=</span><span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span><span class="mf">.05</span><span class="p">],</span><span class="n">bounds</span><span class="o">=</span><span class="p">([</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">],[</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">],[</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>   
<span class="n">zf</span><span class="p">,</span><span class="n">Af</span><span class="o">=</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">],</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">Rc</span><span class="o">=</span><span class="n">calcR</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span><span class="n">Af</span><span class="p">,</span><span class="n">nmr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error is </span><span class="si">{</span><span class="n">fit</span><span class="p">[</span><span class="s2">&quot;fun&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> (should be small– otherwise adjust initial guess)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error is 1.5334372109582631e-07 (should be small– otherwise adjust initial guess)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the results</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">z0</span><span class="p">,</span><span class="n">A0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">):</span>
    <span class="n">hdl0</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">z0</span><span class="p">,</span><span class="n">z0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">A0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span> <span class="k">if</span> <span class="n">z0</span><span class="o">==</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="k">for</span> <span class="n">z0</span><span class="p">,</span><span class="n">A0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span><span class="n">Af</span><span class="p">):</span>
    <span class="n">hdl1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">z0</span><span class="p">,</span><span class="n">z0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">A0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span> <span class="k">if</span> <span class="n">z0</span><span class="o">==</span><span class="n">zf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z=\log_</span><span class="si">{10}</span><span class="s1">(\tau_i/\mathrm</span><span class="si">{s}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$A_i$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Input vs. fitted correlation times and amplitudes&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)),</span><span class="n">R</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Rc</span><span class="p">)),</span><span class="n">Rc</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Rc</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Input vs. fitted rate constants&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/64a3d9efb13231f8fdf1c3e129c9894f62b5b8e2313beffde71646654fa3cfb1.png" src="_images/64a3d9efb13231f8fdf1c3e129c9894f62b5b8e2313beffde71646654fa3cfb1.png" />
<img alt="_images/06ceefe6de7228ccdc6b09d0eafb5cb63fb80832ae3dfadc4111757c84926a1e.png" src="_images/06ceefe6de7228ccdc6b09d0eafb5cb63fb80832ae3dfadc4111757c84926a1e.png" />
</div>
</div>
<p>The data is well-fit, but the parameters themselves are not well-determined, thus not yielding the original parameters. Therefore, we try again with a reduced number of variables, to see what happens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span><span class="o">=</span><span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mf">8.5</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.01</span><span class="p">],</span><span class="n">bounds</span><span class="o">=</span><span class="p">([</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">],[</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>   
<span class="n">zf</span><span class="p">,</span><span class="n">Af</span><span class="o">=</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][:</span><span class="mi">2</span><span class="p">],</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">:]</span>
<span class="n">Rc</span><span class="o">=</span><span class="n">calcR</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span><span class="n">Af</span><span class="p">,</span><span class="n">nmr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error is </span><span class="si">{</span><span class="n">fit</span><span class="p">[</span><span class="s2">&quot;fun&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> (should be small– otherwise adjust initial guess)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error is 4.299710895100029e-07 (should be small– otherwise adjust initial guess)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the results</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">z0</span><span class="p">,</span><span class="n">A0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">):</span>
    <span class="n">hdl0</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">z0</span><span class="p">,</span><span class="n">z0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">A0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span> <span class="k">if</span> <span class="n">z0</span><span class="o">==</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="k">for</span> <span class="n">z0</span><span class="p">,</span><span class="n">A0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span><span class="n">Af</span><span class="p">):</span>
    <span class="n">hdl1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">z0</span><span class="p">,</span><span class="n">z0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">A0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span> <span class="k">if</span> <span class="n">z0</span><span class="o">==</span><span class="n">zf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z=\log_</span><span class="si">{10}</span><span class="s1">(\tau_i/\mathrm</span><span class="si">{s}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$A_i$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Input vs. fitted correlation times and amplitudes&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)),</span><span class="n">R</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Rc</span><span class="p">)),</span><span class="n">Rc</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Rc</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Input vs. fitted rate constants&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6953875343da57398a97c0735b4e137e5c9ed94166c3cc7a98df069c0642a980.png" src="_images/6953875343da57398a97c0735b4e137e5c9ed94166c3cc7a98df069c0642a980.png" />
<img alt="_images/06ceefe6de7228ccdc6b09d0eafb5cb63fb80832ae3dfadc4111757c84926a1e.png" src="_images/06ceefe6de7228ccdc6b09d0eafb5cb63fb80832ae3dfadc4111757c84926a1e.png" />
</div>
</div>
<p>The two fits are nearly equal in quality, whereas only the second yields stable parameters, due to the fewer number of free variables. However, neither fit really reproduces the input correlation times and amplitudes. There isn’t enough information to extract 6 parameters, and so we get parameters that represent some kind of compromise to match the real motion. This is discussed in detail in:</p>
<p>A. A. Smith, M. Ernst, B. H. Meier. <a class="reference external" href="https://doi.org/10.1002/ange.201707316">Because the light is better here: correlation-time analysis by NMR.</a> Angew. Chem. Int. Ed. 2017, 56, 13778-13783.</p>
<p>If it was just a matter of fitting three correlation times instead of two, we might be able to solve this problem by simply obtaining additional experimental data. However, the real problem is that we often have continua of correlation times (hence why we suggest using a distribution of correlation times above (<span class="math notranslate nohighlight">\((1-S^2)\theta(z)\)</span>). Without a model of the correlation function that both accurately describes the motion and has sufficiently few parameters, we fail to be able to get really meaningful dynamics parameters. Furthermore, for proteins, which have a complex structure, it is highly non-trivial to get a good model.</p>
<p>To address this problem, we have developed the <strong>detector</strong> analysis, which we introduce here.</p>
</section>
<section id="basic-detector-theory">
<h2>Basic detector theory<a class="headerlink" href="#basic-detector-theory" title="Link to this heading">#</a></h2>
<p>Suppose that our correlation function is given by an arbitrarily complex sum of decaying exponential terms. We’ll take this to be the rank-2 tensor correlation function used in NMR (here, that just means we assume an initial value of one, and value at <span class="math notranslate nohighlight">\(t=\infty\)</span> of <span class="math notranslate nohighlight">\(S^2\)</span>). Then, this can be written as a distribution of correlation times</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
C(t)=S^2+(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)\exp(-t/(10^z\cdot\mathrm{1 s}))dz}
\end{equation}
\]</div>
<p>Note that if there are a discrete number of correlation times, then the distribution, <span class="math notranslate nohighlight">\((1-S^2)\theta(z)\)</span>, becomes a sum of <span class="math notranslate nohighlight">\(\delta\)</span>-functions, allowing it to also be re-written as a sum of correlation times:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
C(t)=S^2+(1-S^2)\sum\limits_i{A_i\exp(-t/\tau_i)}
\end{equation}
\]</div>
<p>We can then re-express a given relaxation rate constant as a linear function of this distribution. We start by noting that a relaxation rate constant is given by a sum of terms from the spectral density.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
R_\zeta^{(\theta,S)}=\sum\limits_i{a_\zeta^iJ^{(\theta,S)}(\omega_i)}
\end{equation}
\]</div>
<p>The spectral density, <span class="math notranslate nohighlight">\(J^{(\theta,S)}(\omega)\)</span> is, in fact, a linear function of the distribution of correlation times, given by</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
J^{(\theta,S)}(\omega)=2(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)\frac{10^z\cdot\mathrm{1 s}}{1+(\omega\cdot10^z\cdot\mathrm{1 s})^2}dz}
\end{equation}
\]</div>
<p>This is obtained simply by taking the Fourier transform of the individual exponential terms in the correlation function.</p>
<p>Then, we insert the spectra density into the expression for the relaxation rate constant:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
R_\zeta^{(\theta,S)}&amp;=&amp;\sum\limits_i{a_\zeta^iJ^{(\theta,S)}(\omega_i)} \\
&amp;=&amp;\sum\limits_i{a_\zeta^i2(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)\frac{10^z\cdot\mathrm{1 s}}{1+(\omega_i\cdot10^z\cdot\mathrm{1 s})^2}}dz}\\
&amp;=&amp;(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)\cdot2\sum\limits_i{a_\zeta^i\frac{10^z\cdot\mathrm{1 s}}{1+(\omega_i\cdot10^z\cdot\mathrm{1 s})^2}}dz}\\
&amp;=&amp;(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)R_\zeta(z)dz}
\end{eqnarray}
\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
R_\zeta(z)=2\sum\limits_i{a_\zeta^i\frac{10^z\cdot\mathrm{1 s}}{1+(\omega_i\cdot10^z\cdot\mathrm{1 s})^2}}
\end{equation}
\]</div>
<p>While the math may seem a bit overwhelming at first, all we’ve really done is a little shuffling of terms. We point out that a given relaxation rate constant is sensitive to certain correlation times more than others, and its measurement basically provides us a ‘window’, given by <span class="math notranslate nohighlight">\(R_\zeta(z)\)</span>, into the total dynamics. We have named this window a <em>detector sensitivity</em>, which looks at only a certain range of correlation times, as defined by the integral above. pyDIFRATE automatically calculates these windows, as shown below, for a <span class="math notranslate nohighlight">\(^{15}\)</span>N <span class="math notranslate nohighlight">\(T_1\)</span> (protein backbone) acquired at 600 MHz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">Type</span><span class="o">=</span><span class="s1">&#39;R1&#39;</span><span class="p">,</span><span class="n">Nuc</span><span class="o">=</span><span class="s1">&#39;15N&#39;</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span><span class="o">.</span><span class="n">plot_Rz</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/59e0b4e1d4951f49ceb064b901e2764d4e0984b595a7b59edb430e906e238b22.png" src="_images/59e0b4e1d4951f49ceb064b901e2764d4e0984b595a7b59edb430e906e238b22.png" />
</div>
</div>
<p>As one sees, measurement of this <span class="math notranslate nohighlight">\(T_1\)</span> lets us characterize dynamics <em>around</em> roughly 1 ns.</p>
<p>The <em>detector</em> concept comes from noting that, if we have multiple relaxation rate constants, we may add them together to get new windows. For example, we define:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\rho_n^{(\theta,S)}&amp;=&amp;\sum\limits_\zeta{b_\zeta^n R_\zeta^{(\theta,S)}} \\
&amp;=&amp;\sum\limits_\zeta{b_\zeta^n(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)R_\zeta(z)dz}} \\
&amp;=&amp;(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)\sum\limits_\zeta{b_\zeta^n R_\zeta(z)}dz}\\
&amp;=&amp;(1-S^2)\int\limits_{-\infty}^\infty{\theta(z)\rho_n(z)dz}
\end{eqnarray}
\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\rho_n(z)=\sum\limits_\zeta{b_\zeta^n R_\zeta(z)}
\end{equation}
\]</div>
<p>The superscript <span class="math notranslate nohighlight">\(n\)</span> just indicates that there are multiple possible linear combinations of relaxation rate constants. Each linear combination creates a new window, but most possible windows may not be particularly useful. For example, we take two relaxation rate constants below, and show a random set of linear combinations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nmr</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">Type</span><span class="o">=</span><span class="s1">&#39;R1&#39;</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">800</span><span class="p">],</span><span class="n">Nuc</span><span class="o">=</span><span class="s1">&#39;15N&#39;</span><span class="p">)</span>
<span class="n">rho_0</span><span class="o">=</span><span class="n">nmr</span><span class="o">.</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">.5</span><span class="p">)</span><span class="o">+</span><span class="n">nmr</span><span class="o">.</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">rho_1</span><span class="o">=</span><span class="n">nmr</span><span class="o">.</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">.5</span><span class="p">)</span><span class="o">+</span><span class="n">nmr</span><span class="o">.</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">nmr</span><span class="o">.</span><span class="n">tc</span><span class="p">,</span><span class="n">rho_0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">nmr</span><span class="o">.</span><span class="n">tc</span><span class="p">,</span><span class="n">rho_1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau_c$ / s&#39;</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\rho_n(z)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1a4c4063fce652cbbcf84f2cc099580ff50fb3dba0a1a8cae110343994981ddd.png" src="_images/1a4c4063fce652cbbcf84f2cc099580ff50fb3dba0a1a8cae110343994981ddd.png" />
</div>
</div>
<p>However, pyDR is designed to yield the optimal <span class="math notranslate nohighlight">\(n\)</span> windows for a given data set, for example, for the two experiments, we get two optimized windows (The number of optimized windows is always less than or equal to the number of experiments)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="o">=</span><span class="n">nmr</span><span class="o">.</span><span class="n">Detector</span><span class="p">()</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/903cd111b9d49ea025ccb50d5fded92ea8c9d57dd8d6d0bd7175ea4eed30805d.png" src="_images/903cd111b9d49ea025ccb50d5fded92ea8c9d57dd8d6d0bd7175ea4eed30805d.png" />
</div>
</div>
<p>Formally, the linear combination of experimental relaxation rate constants (or any other parameter depending linearly on the correlation function) is referred to as a <em>detector response</em> (<span class="math notranslate nohighlight">\(\rho_n^{(\theta,S)}\)</span>), and the linear combination of sensitivities of the rate constants as <em>detector sensitivities</em> (<span class="math notranslate nohighlight">\(\rho_n(z)\)</span>). In the next chapter, we discuss how the windows are actually optimized.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="References.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><font color="maroon"> References </font></p>
      </div>
    </a>
    <a class="right-next"
       href="Ch2_detector_opt.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><font color="maroon">Chapter 2: Detector Optimization</font></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#models-for-decaying-correlation-functions">Models for decaying correlation functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-angular-correlation-function-for-nmr">The angular correlation function for NMR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-dynamics-data">Fitting dynamics data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-detector-theory">Basic detector theory</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Albert Smith, Kai Zumpfe
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>