
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 6: Anatomy of pyDIFRATE &#8212; pyDIFRATE Tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ch6_pyDRstruct';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 7: Cross-Correlated Dynamics via iRED" href="Ch7_CCana.html" />
    <link rel="prev" title="Chapter 5: Comparing MD and NMR Results" href="Ch5_MDvsNMR.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="pyDIFRATE Tutorial - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="pyDIFRATE Tutorial - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the pyDIFRATE tutorial
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html"><font color="maroon">Getting Started</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="BriefHistory.html"><font color="maroon"> Background </font></a></li>
<li class="toctree-l1"><a class="reference internal" href="References.html"><font color="maroon"> References </font></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Ch1_detectors_intro.html"><font color="maroon"> Chapter 1: A brief introduction to detectors </font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch2_detector_opt.html"><font color="maroon">Chapter 2: Detector Optimization</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch3_basic_NMR.html"><font color="maroon">Chapter 3: A Basic NMR Analysis</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch4_ComparingAnalyses.html"><font color="maroon">Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch5_MDvsNMR.html"><font color="maroon">Chapter 5: Comparing MD and NMR Results</font></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><font color="maroon">Chapter 6: Anatomy of pyDIFRATE</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch7_CCana.html"><font color="maroon">Chapter 7: Cross-Correlated Dynamics via iRED</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch8_ROMANCE_backbone.html"><font color="maroon">Chapter 8: ROMANCE Analysis of Backbone Motion</font></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Templates</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tpl_blank.html"><font color="maroon">Template: pyDR Setup</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tpl_basicNMR.html"><font color="maroon">Template: Basic NMR</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tpl_SolnNMR.html"><font color="maroon">Template: Solution-State NMR</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tpl_CCana.html"><font color="maroon">Template: Cross-Correlated Dynamics via iRED</font></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/alsinmr/pyDR_tutorial" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/alsinmr/pyDR_tutorial/issues/new?title=Issue%20on%20page%20%2FCh6_pyDRstruct.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Ch6_pyDRstruct.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><font color="maroon">Chapter 6: Anatomy of pyDIFRATE</font></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data-object">The Data Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-in-the-data-object">Data in the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sensitivity-of-the-data-object">Sensitivity of the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detectors-for-the-data-object">Detectors for the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-results-in-the-data-object">Fitting results in the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-displays-in-the-data-object">Data displays in the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selections-in-data-object">Selections in data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-information-in-data-object">Source information in data object</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-project-object">The Project Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-data-selection">Project data selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-batch-processing">Project batch processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-plotting">Project plotting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chimerax-in-projects">ChimeraX in projects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-saving-loading">Project saving/loading</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-generation">Data Generation</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-6-anatomy-of-pydifrate">
<h1><font color="maroon">Chapter 6: Anatomy of pyDIFRATE</font><a class="headerlink" href="#chapter-6-anatomy-of-pydifrate" title="Link to this heading">#</a></h1>
<p><a href="https://githubtocolab.com/alsinmr/pyDR_tutorial/blob/main/ColabNotebooks/Ch6_pyDRstruct.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg"></a></p>
<p>pyDR uses object-oriented programming in order to streamline detector analysis and ensure that data is correctly analyzed. The central object in pyDR is the ‘data’ object, which naturally contains dynamics data, but also contains sensitivities for the data set as well as other information about the data, and functions/objects for processing and data display. Data can be stored within a project, and data is created via loading NMR data from text or from processing MD data. The program structure is summarized in the figure below (although this is far from a comprehensive description). This tutorial investigates some of the components of pyDR, and discusses how they work together to simplify and accelerate processing for the user.</p>
<p>The figure below summarizes the structure/workflow of pyDR. Note that each box corresponds to an <a class="reference external" href="https://en.wikipedia.org/wiki/Object_(computer_science)">object</a>, in some cases being contained inside other objects. As one sees, most components of pyDR take advantage of <a class="reference external" href="https://en.wikipedia.org/wiki/Object-oriented_programming">object-oriented programming</a> in order to improve the detector analysis workflow.</p>
<p><img alt="pyDR program structure" src="https://raw.githubusercontent.com/alsinmr/pyDR_tutorial/main/JupyterBook/pyDR_structure.png" /></p>
<section id="the-data-object">
<h2>The Data Object<a class="headerlink" href="#the-data-object" title="Link to this heading">#</a></h2>
<p>Central to pyDR functionality is the data object, which is responsible for storage of experimental and simulated data, as well as data produced by detector analysis. We will select a data object out of a recent project investigating Growth Hormone Secretagogue Receptor using MD simulation (<a class="reference external" href="https://doi.org/10.1002/anie.202302003">source</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SETUP pyDR</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;../..&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Imports</span>
<span class="kn">import</span> <span class="nn">pyDR</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load a project</span>
<span class="n">proj</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="s1">&#39;GHSR_archive/Projects/backboneHN/&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">proj</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1">#Select a particular data object</span>
</pre></div>
</div>
</div>
</div>
<section id="data-in-the-data-object">
<h3>Data in the data object<a class="headerlink" href="#data-in-the-data-object" title="Link to this heading">#</a></h3>
<p>Data can be found in data.R, with its standard deviation in data.Rstd. For NMR data, we may have <span class="math notranslate nohighlight">\(S^2\)</span> data as well (data.S2,data.S2std). These fields are MxN, where M is the number of different locations in the molecule, and N is the number of data points (detectors, experiments, or correlation function time points) for each location.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Experimental data (</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Standard Deviation (</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">Rstd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">Rstd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Rstd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Experimental data (295x7)
[[3.7942290e-01 2.1657662e-01 2.0262545e-01 ... 1.4402686e-01
  1.3009402e-01 5.9126038e-02]
 [2.5403091e-01 1.9350898e-01 2.0336972e-01 ... 1.8837723e-01
  2.1296179e-01 7.7475399e-02]
 [1.9356659e-01 1.3584794e-01 1.8840416e-01 ... 2.7771801e-01
  2.2354510e-01 1.0986746e-01]
 ...
 [9.7813830e-02 1.2932412e-02 1.8070474e-02 ... 6.8756002e-03
  7.5943240e-07 8.7012476e-01]
 [1.0092438e-01 1.7791813e-02 2.7242884e-02 ... 4.0566847e-02
  6.9016963e-03 8.2861245e-01]
 [2.8222382e-01 3.0010650e-01 2.3420739e-01 ... 4.6467399e-03
  3.1937913e-07 3.5440496e-01]]
Standard Deviation (295x7)
[[0.00086905 0.00158777 0.00125429 ... 0.00130778 0.0014115  0.00074924]
 [0.00086905 0.00158777 0.00125429 ... 0.00130778 0.0014115  0.00074924]
 [0.00086905 0.00158777 0.00125429 ... 0.00130778 0.0014115  0.00074924]
 ...
 [0.00086905 0.00158777 0.00125429 ... 0.00130778 0.0014115  0.00074924]
 [0.00086905 0.00158777 0.00125429 ... 0.00130778 0.0014115  0.00074924]
 [0.00086905 0.00158777 0.00125429 ... 0.00130778 0.0014115  0.00074924]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="sensitivity-of-the-data-object">
<h3>Sensitivity of the data object<a class="headerlink" href="#sensitivity-of-the-data-object" title="Link to this heading">#</a></h3>
<p>Each data point in a simulation has its own sensitivity. Each data point tells us something about the dynamics for a given range of correlation times, and that range is determined by the sensitivity. Then, it makes sense to always store the sensitivity object along with the data object. The sensitivity is found in data.sens. A few key components are found in the sensitivity object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">tc</span>        <span class="n">correlation</span> <span class="n">time</span> <span class="n">vector</span> <span class="p">(</span><span class="n">default</span> <span class="mi">10</span> <span class="n">fs</span> <span class="n">to</span> <span class="mi">1</span> <span class="n">ms</span><span class="p">,</span> <span class="n">log</span><span class="o">-</span><span class="n">spaced</span><span class="p">,</span> <span class="mi">200</span> <span class="n">points</span><span class="p">)</span>
<span class="o">.</span><span class="n">z</span>         <span class="n">log</span><span class="o">-</span><span class="n">correlation</span> <span class="n">time</span> <span class="p">(</span><span class="n">default</span> <span class="o">-</span><span class="mi">14</span> <span class="n">to</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">200</span> <span class="n">points</span><span class="p">)</span>
<span class="o">.</span><span class="n">rhoz</span>      <span class="n">Sensitivity</span> <span class="n">of</span> <span class="n">the</span> <span class="n">data</span> <span class="k">as</span> <span class="n">a</span> <span class="n">function</span> <span class="n">of</span> <span class="n">correlation</span> <span class="n">time</span>
           <span class="p">(</span><span class="n">NxM</span><span class="p">,</span> <span class="n">where</span> <span class="n">N</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">data</span> <span class="n">points</span><span class="p">,</span> <span class="n">M</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">times</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">correlation</span> <span class="n">time</span> <span class="n">axis</span><span class="p">)</span>
<span class="o">.</span><span class="n">plot_rhoz</span> <span class="n">Plots</span> <span class="n">rhoz</span> <span class="n">vs</span><span class="o">.</span> <span class="n">tc</span>
<span class="o">.</span><span class="n">info</span>      <span class="n">Parameters</span> <span class="n">describing</span> <span class="p">(</span><span class="ow">or</span> <span class="n">used</span> <span class="n">to</span> <span class="n">calculate</span><span class="p">)</span> <span class="n">the</span> <span class="n">sensitivities</span>
<span class="o">.</span><span class="n">Detector</span>  <span class="n">Produces</span> <span class="n">a</span> <span class="n">detector</span> <span class="nb">object</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">sensitivity</span> <span class="nb">object</span>
</pre></div>
</div>
<p>Here, we plot the sensitivity of the data for example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e431be2153fab64da76d49308505ebf13d24bdfd1ed1fbf1e3e0d0795d0df0bb.png" src="_images/e431be2153fab64da76d49308505ebf13d24bdfd1ed1fbf1e3e0d0795d0df0bb.png" />
</div>
</div>
<p>We see that there are seven detectors, with sensitivity ranges from below (~100 ps) to above (~3 <span class="math notranslate nohighlight">\(\mu\)</span>s). From <a class="reference external" href="http://sens.info">sens.info</a>, we can find out the mean position of the detectors (here, we convert from the log scale to ns). Note that the first and last detector do not really have a mean position (although one is nonetheless calculated), since they remain positive for arbitrarily short/long correlation times, respectively</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">z0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;z0&#39;</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;rho</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">: ~ </span><span class="si">{</span><span class="mi">10</span><span class="o">**</span><span class="n">z0</span><span class="o">*</span><span class="mf">1e9</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1"> ns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rho0: ~ 0.0013 ns
rho1: ~ 0.58 ns
rho2: ~ 4.3 ns
rho3: ~ 5.5e+01 ns
rho4: ~ 5.3e+02 ns
rho5: ~ 7e+03 ns
rho6: ~ 1.4e+05 ns
</pre></div>
</div>
</div>
</div>
<p>The <a class="reference external" href="http://sens.info">sens.info</a> object is particularly useful in summarizing relevant parameters for the sensitivity of a given data object. It is also accessible via <a class="reference external" href="http://data.info">data.info</a>. Note that <a class="reference external" href="http://sens.info">sens.info</a> for an NMR or MD sensitivity yields parameters from which the sensitivities may be calculated, whereas for detectors, <a class="reference external" href="http://sens.info">sens.info</a> only characterizes the sensitivities, but cannot calculate them. We show below the sensitivity of this data (detectors), but also create an NMR sensitivity object, and show <a class="reference external" href="http://data.info">data.info</a>, to highlight the differences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Info for detector:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
<span class="n">nmr</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">Nuc</span><span class="o">=</span><span class="s1">&#39;15N&#39;</span><span class="p">,</span><span class="n">Type</span><span class="o">=</span><span class="s1">&#39;R1&#39;</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="p">[</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">800</span><span class="p">])</span><span class="o">.</span><span class="n">new_exper</span><span class="p">(</span><span class="n">Nuc</span><span class="o">=</span><span class="s1">&#39;15N&#39;</span><span class="p">,</span><span class="n">Type</span><span class="o">=</span><span class="s1">&#39;R1p&#39;</span><span class="p">,</span><span class="n">v0</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">vr</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">v1</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">Info for NMR sensitivity:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nmr</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Info for detector:
                 0           1           2           3           4           5           6
z0      -11.887198  -9.2347894  -8.3647531  -7.2601854  -6.2729486  -5.1564855  -3.8648295
zmax    -12.728643  -9.3015075  -8.3618090  -7.2562814  -6.2613065  -5.2110552        -3.0
Del_z   4.24162168  1.46730976  1.65835556  1.60612970  1.62059535  1.61260870  1.61039228
stdev   0.00150523  0.00275009  0.00217250  0.00231370  0.00226514  0.00244478  0.00129772

[7 experiments with 4 parameters]


Info for NMR sensitivity:
                 0         1         2         3         4         5
Type            R1        R1        R1       R1p       R1p       R1p
v0             400       600       800       600       600       600
v1               0         0         0        10        30        50
vr               0         0         0        60        60        60
offset           0         0         0         0         0         0
stdev            0         0         0         0         0         0
med_val          0         0         0         0         0         0
Nuc            15N       15N       15N       15N       15N       15N
Nuc1            1H        1H        1H        1H        1H        1H
dXY       -22954.8  -22954.8  -22954.8  -22954.8  -22954.8  -22954.8
CSA          113.0     113.0     113.0     113.0     113.0     113.0
eta              0         0         0         0         0         0
CSoff            0         0         0         0         0         0
QC               0         0         0         0         0         0
etaQ             0         0         0         0         0         0
theta         23.0      23.0      23.0      23.0      23.0      23.0

[6 experiments with 16 parameters]
</pre></div>
</div>
</div>
</div>
</section>
<section id="detectors-for-the-data-object">
<h3>Detectors for the data object<a class="headerlink" href="#detectors-for-the-data-object" title="Link to this heading">#</a></h3>
<p>The next critical component of the data object is the Detector object (data.detect). The detector object provides the instructions on how to fit the data (when calling data.fit()). The detector object is derived from the sensitivity object (data.detect=data.sens.Detector()), and the detector object always contains the original data object (data.detect.sens). We can demonstrate this below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Demonstrate that the detector object contains the sensitivity object</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Is the detector object</span><span class="se">\&#39;</span><span class="s1">s sensitivity the same and the sensitivity of the data?&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sens</span> <span class="ow">is</span> <span class="n">data</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">sens</span><span class="p">)</span>
<span class="c1"># Produce the detector object from the sensitivity object</span>
<span class="n">r</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">Detector</span><span class="p">()</span> <span class="c1">#Produce a detector object from a sensitivity object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Is the detector object&#39;s sensitivity the same and the sensitivity of the data?
True
</pre></div>
</div>
</div>
</div>
<p>Then, the detector object can be optimized in a variety of ways for data analysis. However, it is not recommended to re-analyze data that has already been analyzed with detectors <em>unless</em> un-optimized detectors have been used. Then, we will demonstrate based on the original sensitivity object for this data set. This data has gone through two layers of processing, so we have to go two sensitivities back (note, furthermore, that the sensitivity of processed data is the detector object for the data having been processed)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sens</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">sens</span>
<span class="n">_</span><span class="o">=</span><span class="n">sens</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">()</span>  <span class="c1">#This plots only a selection of MD sensitivities by default</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0309e3f038dcab73d794ddd09c84dc98e01a153c363f36b7e78fa7b385fda345.png" src="_images/0309e3f038dcab73d794ddd09c84dc98e01a153c363f36b7e78fa7b385fda345.png" />
</div>
</div>
<p>We first create a detector object from the sensitivity object. pyDR does this automatically when a data object is created (data.detect=data.sens.Detector()). However, here, we have to do this step ourselves.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r0</span><span class="o">=</span><span class="n">sens</span><span class="o">.</span><span class="n">Detector</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>For NMR data, we usually just optimize the detectors with ‘detect.r_auto’, but for MD, we often take an intermediate step, using detect.r_no_opt()</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r0</span><span class="o">.</span><span class="n">r_no_opt</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>     <span class="c1">#Create detectors with r_no_opt, using 12 detectors</span>
<span class="n">_</span><span class="o">=</span><span class="n">r0</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">()</span>    <span class="c1">#Plot the result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/89e479f5de40927ae3d43a770c05fba2b3d3f2d9cd102e8f74735fdeaf66d4b7.png" src="_images/89e479f5de40927ae3d43a770c05fba2b3d3f2d9cd102e8f74735fdeaf66d4b7.png" />
</div>
</div>
<p>The raw correlation function data can be fitted with the <em>unoptimized</em> detectors and stored, which vastly reduces the data size, but loses very little correlation time information. In a subsequent step, one can use ‘r_auto’ or ‘r_target’. Once data has been processed with detectors using ‘r_auto’ or ‘r_target’, the data should ideally not be reprocessed (rather, go back to the unoptimized detectors, and apply differnet processing from there).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span><span class="o">=</span><span class="n">r0</span><span class="o">.</span><span class="n">Detector</span><span class="p">()</span>  <span class="c1">#Create another detector</span>
<span class="n">r1</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>      <span class="c1">#Create 7 optimized detectors</span>
<span class="n">_</span><span class="o">=</span><span class="n">r1</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">()</span>  <span class="c1">#Plot the results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/981f0c6a52bbbb1cde6d707526c498941066b8764417b38478bfb31512fd84e5.png" src="_images/981f0c6a52bbbb1cde6d707526c498941066b8764417b38478bfb31512fd84e5.png" />
</div>
</div>
<p>It is important to note: we get the same detectors going directly from MD data to optimized detector windows as if we go via two steps, using unoptimized detector windows in between. Copy the following code into a cell if you want to check.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r2</span><span class="o">=</span><span class="n">sens</span><span class="o">.</span><span class="n">Detector</span><span class="p">()</span> <span class="c1">#Detectors generated from the original sensitivity</span>
<span class="n">r2</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>       <span class="c1">#Create 7 optimized detectors</span>
<span class="n">ax</span><span class="o">=</span><span class="n">r2</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span> <span class="c1">#Plot the result</span>
<span class="n">_</span><span class="o">=</span><span class="n">r1</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>  <span class="c1">#Overlay the results</span>
</pre></div>
</div>
</section>
<section id="fitting-results-in-the-data-object">
<h3>Fitting results in the data object<a class="headerlink" href="#fitting-results-in-the-data-object" title="Link to this heading">#</a></h3>
<p>A data object, by default contains (or can back calculate), the results of fitting. These results are found in data.Rc. Note a data object can also contain a reference to the original (source) data (data.src_data), although if the source data consisted of long correlation functions, then it is usually discarded if the data is saved and reloaded.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">Rc</span>   <span class="c1">#Back-calculated parameters </span>
<span class="n">data</span><span class="o">.</span><span class="n">src_data</span> <span class="c1">#Reference to the original data object</span>
</pre></div>
</div>
<p>A comparison of the back-calculated data and the original data may be obtained with data.plot_fit(). In this example, the source data was the result of first fitting to 15 unoptimized detectors and subsequently fitting with seven optimized detectors. Then, the raw correlation functions are not available here (they are not saved because this data is orders-of-magnitude larger than the processed data). We can, however, check the fit of the unoptimized detectors when using optimized detectors. In this case, we find that the first 7 unoptimized detectors are almost perfectly fit (with small error due to bounds placed on the result– eliminating the bounds will eliminate the error), but the latter 8 detectors are not fit at all. This comes about because the 7 optimized detectors use exactly the first 7 singular values to fit the data, and discard the latter 8.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">Rc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 7.05541598e-02,  1.31131795e-02,  1.56836598e-02, ...,
         2.72427192e-12,  9.10197174e-13,  9.64890409e-14],
       [ 7.06657670e-02, -6.53508201e-03,  2.49433414e-02, ...,
         6.03828888e-12,  1.02053561e-12, -4.07342574e-14],
       [ 7.07414883e-02, -2.08076652e-02,  2.92742123e-02, ...,
         4.99809518e-13,  7.92258083e-14, -2.48752729e-13],
       ...,
       [ 7.05414347e-02, -8.72078078e-02, -8.89642359e-02, ...,
        -1.14633327e-11,  2.81733530e-12,  2.85738900e-12],
       [ 7.05249584e-02, -8.40580211e-02, -8.18875549e-02, ...,
        -1.26868845e-11,  2.43656332e-12,  2.64733752e-12],
       [ 7.09807861e-02, -7.09484324e-03, -2.35905914e-02, ...,
        -3.47984956e-12,  2.93911542e-12,  1.81354237e-12]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot_fit</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e1fbfc03542c018f0a9a6cb9bfb95e77f65941ba24e7554b1ef7338a6b941172.png" src="_images/e1fbfc03542c018f0a9a6cb9bfb95e77f65941ba24e7554b1ef7338a6b941172.png" />
</div>
</div>
<p>Below, we print the median relative error for each detector. Note that there is some error for the first seven detectors. This comes because non-exponentiality in the correlation functions (from noise or other sources) may lead to an unphysical set of unoptimized detectors, where bounds on the optimized detectors eliminates some of this unphysicality, but results in mis-fit of the unoptimized detectors. This error can be eliminated by not enforcing the bounds (as done below in fit_nobounds).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_nobounds</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">src_data</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Relative error&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Detector w/ bounds w/o bounds&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">R</span><span class="p">,</span><span class="n">Rc</span><span class="p">,</span><span class="n">Rcnb</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">src_data</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">Rc</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">fit_nobounds</span><span class="o">.</span><span class="n">Rc</span><span class="o">.</span><span class="n">T</span><span class="p">)):</span>
    <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">R</span><span class="o">-</span><span class="n">Rc</span><span class="p">)</span><span class="o">/</span><span class="n">R</span><span class="p">))</span>
    <span class="n">error_nb</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">R</span><span class="o">-</span><span class="n">Rcnb</span><span class="p">)</span><span class="o">/</span><span class="n">R</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  rho</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s1">&gt;2</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s1">&lt;9.2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">error_nb</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data already in project (index=12)
Relative error
Detector w/ bounds w/o bounds
  rho 0: 0.0024    1.5e-08
  rho 1: 0.0018    2.1e-08
  rho 2: 0.0062    2.1e-08
  rho 3: 0.011     2.4e-08
  rho 4: 0.016     2.3e-08
  rho 5: 0.04      2.3e-08
  rho 6: 0.13      2e-08
  rho 7: 1.0       1.0
  rho 8: 1.0       1.0
  rho 9: 1.0       1.0
  rho10: 1.0       1.0
  rho11: 1.0       1.0
  rho12: 1.0       1.0
  rho13: 1.0       1.0
  rho14: 1.0       1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-displays-in-the-data-object">
<h3>Data displays in the data object<a class="headerlink" href="#data-displays-in-the-data-object" title="Link to this heading">#</a></h3>
<p>While all the theoretical efforts going into pyDR are important, it is equally critical to easily visualize our data. The pyDR data object implements the .plot function, as well as extensive functionality for 3D visualization in <a class="reference external" href="https://www.cgl.ucsf.edu/chimerax/">ChimeraX</a> and more limited visualization in <a class="reference external" href="https://nglviewer.org/">NGL viewer</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">chimeraX</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">nglview</span><span class="p">(</span><span class="n">rho_index</span><span class="p">)</span>  
</pre></div>
</div>
<p>We show data.plot below. ChimeraX will only work locally. It can be launched from Jupyter or other Python console, but runs as a separate program, and Colab does not support its running separately from the Colab notebook. NGL viewer runs in both Jupyter and Colab cells, but rendering in Colab often fails to produce coloring. This appears to be a Colab problem, rather than an NGLview or pyDR problem (NGL viewer works locally).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="o">.</span><span class="n">close_fig</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f21b14f936c2509c96a18dd6f5671507731e010af04937e5b10aada671cb1c2e.png" src="_images/f21b14f936c2509c96a18dd6f5671507731e010af04937e5b10aada671cb1c2e.png" />
</div>
</div>
<p>Below, we execute chimera (won’t work in Colab). Once the molecule is open in ChimeraX, you can mouse over the different detectors in the upper right corner to see the different detector responses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pyDR.chimeraX.chimeraX_funs.set_chimera_path(&#39;path_to_executable&#39;) #Needs to be run once</span>
<span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
    <span class="n">data</span><span class="o">.</span><span class="n">chimera</span><span class="p">()</span>
    <span class="n">proj</span><span class="o">.</span><span class="n">chimera</span><span class="o">.</span><span class="n">command_line</span><span class="p">([</span><span class="s1">&#39;~show ~@N,C,CA&#39;</span><span class="p">,</span><span class="s1">&#39;set bgColor white&#39;</span><span class="p">,</span><span class="s1">&#39;lighting soft&#39;</span><span class="p">])</span>  <span class="c1">#Send a command to ChimeraX to adjust the view</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="selections-in-data-object">
<h3>Selections in data object<a class="headerlink" href="#selections-in-data-object" title="Link to this heading">#</a></h3>
<p>Our ability to plot data onto the molecule, and also to compare data from different sources to the same positions on the molecule comes from the association of the dynamics data with particular bonds on a molecule. This association is defined by a MolSelect instance (data.select). The key components of this object are the bond selections (defined by .sel1, .sel2), the “representative selection”, which usually contains the atoms in sel1 and sel2, but may contain additional atoms to improve visibility of the dynamics (e.g. for H–N motion, we include the whole peptide plane in the representative selection). The selection object also suggests a unique set of labels for the set of bonds in the selection object (used for MD labeling), which are often assigned to the data object upon data generation from MD simulations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">sel1</span>  <span class="c1">#First atom in bond</span>
<span class="n">data</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">sel2</span>  <span class="c1">#Second atom in bond</span>
<span class="n">data</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">repr_sel</span> <span class="c1">#Atoms on which to encode data</span>
<span class="n">data</span><span class="o">.</span><span class="n">label</span>  <span class="c1">#Unique set of labels for selected bonds</span>
</pre></div>
</div>
</section>
<section id="source-information-in-data-object">
<h3>Source information in data object<a class="headerlink" href="#source-information-in-data-object" title="Link to this heading">#</a></h3>
<p>pyDR keeps careful track of where data came from, to avoid later confusion on what happened in the data processing procedure. It is also important to organize data in Projects. This is largely managed by the data.source object. We will not list all attributes of data.source here, but a few critical attributes are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>   <span class="n">File</span> <span class="ow">or</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">files</span> <span class="kn">from</span> <span class="nn">which</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">derived</span>
<span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">short_file</span><span class="p">:</span> <span class="n">Shortened</span> <span class="n">version</span> <span class="n">of</span> <span class="n">above</span> <span class="p">(</span><span class="n">just</span> <span class="n">one</span> <span class="n">string</span><span class="p">)</span>
<span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>     <span class="n">Processing</span> <span class="n">status</span> <span class="n">of</span> <span class="n">the</span> <span class="n">data</span> <span class="p">(</span><span class="n">raw</span><span class="p">,</span><span class="n">no_opt</span><span class="p">,</span><span class="n">proc</span><span class="p">,</span><span class="n">opt_fit</span><span class="p">,</span> <span class="n">abbreviated</span> <span class="k">as</span> <span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">o</span><span class="p">)</span>
<span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">Type</span><span class="p">:</span>       <span class="n">Type</span> <span class="n">of</span> <span class="n">data</span> <span class="p">(</span><span class="n">NMR</span><span class="p">,</span><span class="n">MD</span><span class="p">,</span><span class="n">FRAMES</span><span class="p">,</span><span class="n">IRED</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span><span class="p">)</span>
<span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">additional_info</span> <span class="n">Additional</span> <span class="n">data</span> <span class="n">description</span>
<span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">n_det</span>       <span class="n">Number</span> <span class="n">of</span> <span class="n">detector</span> <span class="p">(</span><span class="k">if</span> <span class="ow">not</span> <span class="n">raw</span> <span class="n">data</span><span class="p">)</span>
<span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">title</span>       <span class="n">Title</span> <span class="n">constructed</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">above</span> <span class="n">information</span>
</pre></div>
</div>
<p>The title summarizes a lot of this information. While the user can overwrite the default title, we find the default title fairly powerful for describing what is in the data set. For example, the title of our example data object is
<strong>o7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein</strong>
which means:</p>
<ul class="simple">
<li><p>o: Optimized fit (status)</p></li>
<li><p>7: Seven detectors (n_det)</p></li>
<li><p>FRAMES: Data extracted from a frame analysis (Type)</p></li>
<li><p>AvOb: Data was averaged over several data objects (additional_info)</p></li>
<li><p>WT-apo_run1_0.1ns_just_protein (short_file)</p></li>
</ul>
<p>Note that data.source and the project work together to make sure that there are unique names for saving data. Titles need not be unique.</p>
<p>Also note: the user may overwrite the data title if desired, but the corresponding project object must be informed of this action manually.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;new_title&#39;</span>
<span class="n">proj</span><span class="o">.</span><span class="n">update_info</span><span class="p">()</span>  
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">n_det</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">Type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">additional_info</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">short_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>  <span class="c1">#This links to data.source.title</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>opt_fit
7
Frames
AvOb
WT-apo_run1_0.1ns_just_protein.xtc
o7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
o7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
</pre></div>
</div>
</div>
</div>
<p>data.source also keeps a detailed, plain text processing history (data.source.details). It can also be accessed from data.details. This particular data set was obtained using averages over 3 MD trajectories and each trajectory was chunked by residue into 5 parts, so there are 15 combined data objects, making the details much longer than usual. We print part of the details here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">details</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">details</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Average of 3 data objects
Warning: Selection, labels, and information in source correspond to the first data object
START DATA OBJECT 0
Appending 5 data objects
Warning: Information in source corresponds to the first data object
START DATA OBJECT 0
Topology: /work/public/ghrelin-receptor/WT-apo_run1_just_protein.pdb
Trajectory:/work/public/ghrelin-receptor/WT-apo_run1_0.1ns_just_protein.xtc
t0=0, tf=355000, step=1, dt=100.0 ps, original length=372685
Selection with 59 elements
...
Rotation between frames PAS and superimpose
Fitted with 15 detectors (bounds:False)
Detector optimization type: no_opt
Normalizaton: None, NegAllow: False, Options:
END DATA OBJECT 4
END DATA OBJECT 2
Fitted with 7 detectors (bounds:True)
Detector optimization type: auto
Normalizaton: MP, NegAllow: False, Options:
Data fit optimized with opt2dist (rhoz_cleanup:True)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="the-project-object">
<h2>The Project Object<a class="headerlink" href="#the-project-object" title="Link to this heading">#</a></h2>
<p>While Projects are not required for using pyDR, they are particularly helpful in organizing/processing/saving/displaying data. They provide a straightforward data sorting mechanism, and automatically manage the displaying of data, including data superposition. They also allow execution of processing commands on multiple data sets at once.</p>
<p>We can see what’s in a Project, just by typing the name of the Project object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDIFRATE project with 13 data sets
&lt;pyDR.Project.Project.Project object at 0x7fbce08beca0&gt;

Titles:
n15:FRAMES:WT-apo_run1_0.1ns_just_protein
n15:FRAMES:WT-apo_run2_0.1ns_just_protein
n15:FRAMES:WT-apo_run3_0.1ns_just_protein
n15:FRAMES:WT-ghrelin_run1_0.1ns_just_protein
n15:FRAMES:WT-ghrelin_run2_0.1ns_just_protein
n15:FRAMES:WT-ghrelin_run3_0.1ns_just_protein
n15:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
n15:FRAMES:AvOb:WT-ghrelin_run1_0.1ns_just_protein
p7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
p7:FRAMES:AvOb:WT-ghrelin_run1_0.1ns_just_protein
o7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
o7:FRAMES:AvOb:WT-ghrelin_run1_0.1ns_just_protein
p7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
</pre></div>
</div>
</div>
</div>
<section id="project-data-selection">
<h3>Project data selection<a class="headerlink" href="#project-data-selection" title="Link to this heading">#</a></h3>
<p>It’s possible to select one or more data objects out of a project using a variety of methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">Single</span> <span class="n">index</span> <span class="n">returns</span> <span class="n">one</span> <span class="n">data</span> <span class="nb">object</span>
<span class="n">proj</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="p">:</span> <span class="n">Slicing</span> <span class="n">returns</span> <span class="n">several</span> <span class="n">elements</span> <span class="n">of</span> <span class="n">the</span> <span class="n">project</span> 
<span class="n">proj</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span> <span class="p">:</span> <span class="n">List</span> <span class="n">returns</span> <span class="n">selected</span> <span class="n">elements</span> <span class="n">of</span> <span class="n">project</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;proc&#39;</span><span class="p">]</span> <span class="p">:</span> <span class="n">Keywords</span> <span class="k">return</span> <span class="n">parts</span> <span class="n">of</span> <span class="n">project</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;.+AvOb.+apo&#39;</span><span class="p">]</span> <span class="p">:</span> <span class="n">Regular</span> <span class="n">expressions</span> <span class="nb">filter</span> <span class="n">project</span> <span class="n">based</span> <span class="n">on</span> <span class="n">title</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">][</span><span class="s1">&#39;.+apo&#39;</span><span class="p">]</span> <span class="p">:</span> <span class="n">String</span> <span class="n">together</span> <span class="n">multiple</span> <span class="n">fills</span>

<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;WT-apo&#39;</span><span class="p">]</span> <span class="p">:</span> <span class="n">Combine</span> <span class="n">subprojects</span> <span class="p">(</span><span class="n">must</span> <span class="n">be</span> <span class="n">the</span> <span class="n">same</span> <span class="n">parent</span> <span class="n">project</span><span class="p">)</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;.ghrelin&#39;</span><span class="p">]</span> <span class="p">:</span> <span class="n">Set</span> <span class="n">difference</span><span class="o">/</span><span class="n">relative</span> <span class="n">complement</span>
</pre></div>
</div>
<p>Note: a single index returns a data object. All other methods return a subproject, even if that subproject only contains a single data object. However, most attributes of the data object in a subproject with only one element are accessible directly from the subproject, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">][</span><span class="s1">&#39;.+WT-apo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">R</span>
</pre></div>
</div>
<p>yields the data in the selected data object</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;.+AvOb.+apo&#39;</span><span class="p">]</span>   <span class="c1">#Regular expressions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDIFRATE project with 3 data sets
&lt;pyDR.Project.Project.Project object at 0x7f850a37d828&gt;

Titles:
n15:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
p7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
o7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">]</span><span class="o">&amp;</span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;.+apo&#39;</span><span class="p">]</span>   <span class="c1">#Intersection</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDIFRATE project with 1 data sets
&lt;pyDR.Project.Project.Project object at 0x7fbcb0619340&gt;

Titles:
o7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">][</span><span class="s1">&#39;.+apo&#39;</span><span class="p">]</span>    <span class="c1">#Intersection (via multiple indexing)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDIFRATE project with 1 data sets
&lt;pyDR.Project.Project.Project object at 0x7fbcb0619220&gt;

Titles:
o7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;proc&#39;</span><span class="p">]</span>  <span class="c1">#Union</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDIFRATE project with 11 data sets
&lt;pyDR.Project.Project.Project object at 0x7fbce36071c0&gt;

Titles:
n15:FRAMES:WT-apo_run1_0.1ns_just_protein
n15:FRAMES:WT-apo_run2_0.1ns_just_protein
n15:FRAMES:WT-apo_run3_0.1ns_just_protein
n15:FRAMES:WT-ghrelin_run1_0.1ns_just_protein
n15:FRAMES:WT-ghrelin_run2_0.1ns_just_protein
n15:FRAMES:WT-ghrelin_run3_0.1ns_just_protein
n15:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
n15:FRAMES:AvOb:WT-ghrelin_run1_0.1ns_just_protein
p7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
p7:FRAMES:AvOb:WT-ghrelin_run1_0.1ns_just_protein
p7:FRAMES:AvOb:WT-apo_run1_0.1ns_just_protein
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;WT-apo_run1_0.1ns_just_protein&#39;</span><span class="p">]</span> <span class="c1">#Set difference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDIFRATE project with 1 data sets
&lt;pyDR.Project.Project.Project object at 0x7fbcb06198b0&gt;

Titles:
o7:FRAMES:AvOb:WT-ghrelin_run1_0.1ns_just_protein
</pre></div>
</div>
</div>
</div>
<p>As mentioned above, subprojects with only one data object automatically obtain attributes of that data object (unless project already has the attribute– e.g., a subproject always uses the proj.chimera object, rather than the data.chimera function). Usually, the user will not notice the difference, but occasionally this can become important. Here we demonstrate how the full project has no attribute ‘R’, but a subproject with a single element does have ‘R’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">hasattr</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">hasattr</span><span class="p">(</span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">][</span><span class="s1">&#39;.+apo&#39;</span><span class="p">],</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="project-batch-processing">
<h3>Project batch processing<a class="headerlink" href="#project-batch-processing" title="Link to this heading">#</a></h3>
<p>The functions .fit, .opt2dist, and .modes2bonds (iRED) can be applied to a (sub-)project and will be applied to all data within. Also, proj.detect allows batch optimization of detectors. In fact, the project will test to see if some of the detector objects are originating from identical sensitivities and will replace them with a unified object if so, avoiding redundant detector optimization. We’ll show the procedure for re-fitting some of the no-opt data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt&#39;</span><span class="p">][</span><span class="s1">&#39;AvOb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1">#Optimize detectors</span>
<span class="n">_</span><span class="o">=</span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt&#39;</span><span class="p">][</span><span class="s1">&#39;AvOb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitted 2 data objects
</pre></div>
</div>
</div>
</div>
<p>We can check and see that indeed the detector objects in the subproject are now the same object, thus removing the need to optimize both.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt&#39;</span><span class="p">][</span><span class="s1">&#39;AvOb&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detect</span> <span class="ow">is</span> <span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt&#39;</span><span class="p">][</span><span class="s1">&#39;AvOb&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">detect</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>In most cases, this will not cause the user any problems, but one needs to be aware that subsequent detector optimizations of either of the detectors will automatically be applied to both. This behavior can be avoided by enforcing <em>unique detectors</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt&#39;</span><span class="p">][</span><span class="s1">&#39;AvOb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">unique_detect</span><span class="p">()</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt&#39;</span><span class="p">][</span><span class="s1">&#39;AvOb&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detect</span> <span class="ow">is</span> <span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt&#39;</span><span class="p">][</span><span class="s1">&#39;AvOb&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">detect</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>It is also useful to note: when running .fit, .opt2dist, and .modes2bonds in a Project, the result returns a subproject that only contains the newly created data. Then it is possible to <em>pipe</em> the results through multiple processing steps. For example, suppose we have some iRED data that we want to fit, optimize, convert to bonds, and plot, we could run in one line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt&#39;</span><span class="p">][</span><span class="s1">&#39;iREDmode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">opt2dist</span><span class="p">(</span><span class="n">rhoz_cleanup</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">modes2bonds</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>On the other hand, without the piping, we have to re-index the project at each step to make sure we operate on the correct data set.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;no_opt][&#39;</span><span class="n">iREDmode</span><span class="s1">&#39;].fit()</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;proc&#39;</span><span class="p">][</span><span class="s1">&#39;iREDmode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">opt2dist</span><span class="p">(</span><span class="n">rhoz_cleanup</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">][</span><span class="s1">&#39;iREDmode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">modes2bonds</span><span class="p">()</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;opt_fit&#39;</span><span class="p">][</span><span class="s1">&#39;iREDbond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="project-plotting">
<h3>Project plotting<a class="headerlink" href="#project-plotting" title="Link to this heading">#</a></h3>
<p>When we plot data contained in a project, it is automatically plotted into a <em>plot object</em> contained within the project (proj.plt_obj). A project has an active plot object (proj.current_plot, indexed from 1), but may also have inactive plots. When plotting, data always goes into the active plot. To create a blank plot object, just change the current_plot to an unused value (or close all plots, proj.close_fig(‘all’)).</p>
<p>Note that the plot_obj is returned when a plot is created, or one can obtain the current plot object from proj.plt_obj.</p>
<p>plt_obj contains access to the various axes (.ax, .ax_sens) and figure (.fig). plt_obj.show_tc() will display the average correlation time for each detector on the corresponding plot.</p>
<p>Note that assignment of the plt_obj to a variable will suppress its display, and will need to be called later. In some Python consoles, the plot only appears if you run plt_obj.fig.show().</p>
<p>Plot object plots can be saved to the project folder by calling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>Plots may also be saved outside the project folder by providing the full path (not relative path!) to the desired destination.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="o">.</span><span class="n">close_fig</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;o7&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show_tc</span><span class="p">()</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span> 
<span class="c1">#Create the plot, show correlation times in the plot, adjust the figure size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/807aa1aede872cd70f4d98a1f7971749df75dbef4ca622343f9578ebfd857d47.png" src="_images/807aa1aede872cd70f4d98a1f7971749df75dbef4ca622343f9578ebfd857d47.png" />
</div>
</div>
<p>In the above plot, it is difficult to see the differences between the two data objects (data sets are differentiated by hashes on the bars), so we can instead plot them with two different plot types (plot types are line plots: ‘p’, bar plots: ‘b’, and scatter plots: ‘s’)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="o">.</span><span class="n">close_fig</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;o7.+ghrelin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show_tc</span><span class="p">()</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="n">proj</span><span class="p">[</span><span class="s1">&#39;o7.+apo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plot&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/edd8c3f26b04e341272ed52ab16a3cfeb1ccb3fa9b3350eb61154568dc69aade.png" src="_images/edd8c3f26b04e341272ed52ab16a3cfeb1ccb3fa9b3350eb61154568dc69aade.png" />
</div>
</div>
</section>
<section id="chimerax-in-projects">
<h3>ChimeraX in projects<a class="headerlink" href="#chimerax-in-projects" title="Link to this heading">#</a></h3>
<p>proj.chimera also provides special functionality. For example, when calling chimera for data within a project, the project will retain communcation with the chimeraX instance such that one may add additional molecules to it, send commands to chimeraX via the command line, and save the results. We can also use multiple chimera instances (tested on Mac/Linux), by changing current.</p>
<p>Note that occasionally, communication with ChimeraX is lost for one reason or another. pyDR should automatically create a new instance/connection, but the previous instance will need to be manually closed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>proj.chimera()           :  Send all data sets in the project to chimera
.chimera.command_line    :  ChimeraX command or list of commands
.chimera.savefig         :  Saves the figure (goes into project folder unless full path given!)
.chimera.current         :  Switch the current chimera instance (not a function- just set the value)
.chimera.close           :  Close the specified model in chimera (or leave blank for all models)
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;o7&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">chimera</span><span class="p">()</span>  <span class="c1">#Show two data sets in chimera</span>
<span class="n">proj</span><span class="o">.</span><span class="n">chimera</span><span class="o">.</span><span class="n">command_line</span><span class="p">(</span><span class="s1">&#39;~show ~@N,C,CA&#39;</span><span class="p">)</span>  <span class="c1">#Just show the backbone</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="project-saving-loading">
<h3>Project saving/loading<a class="headerlink" href="#project-saving-loading" title="Link to this heading">#</a></h3>
<p>When a project is created, we may specify a directory to allow that project later to be saved (projects consist of folders). Note that we may also create an empty project without a directory but then it will not be possible to save the project later. If we are making a new project, we must specify create=True.</p>
<p>A project is saved simply by specifying proj.save()</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="s1">&#39;my_new_project&#39;</span><span class="p">,</span><span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1">#create a new project</span>
<span class="n">proj</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="s1">&#39;my_existing_project&#39;</span><span class="p">)</span>         <span class="c1">#load an existing project</span>
<span class="n">proj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that proj.save will exclude large, raw MD data sets by default, since they may take gigabytes of space (whereas a typical project is usually a few MB). Set include_rawMD=True to override this behavior.</p>
<p>Projects also manage memory/time by only loading data that has actually been requested. Then, opening a project is fast, but the first access to a data set in the project may take some time (usually also short except for large data sets). proj.clear_memory will remove references to all data sets from the project, although this does not guarantee a data cleanup, and therefore reduced memory, if other references exist.</p>
</section>
</section>
<section id="data-generation">
<h2>Data Generation<a class="headerlink" href="#data-generation" title="Link to this heading">#</a></h2>
<p>The final question in this chapter, is how do we get data in the first place, and how do we put it into projects?</p>
<p>NMR data is already prepared and stored in a text file. Then, we may either load the data object and then append to a project, or just provide the path/link to the project directly. We’ll make an empty project to test this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Project</span><span class="p">()</span>  <span class="c1">#Project (without directory)</span>

<span class="n">nmr_data</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readNMR</span><span class="p">(</span><span class="s1">&#39;pyDR/examples/HETs15N/HETs_15N.txt&#39;</span><span class="p">)</span>  <span class="c1">#File path</span>
<span class="n">proj</span><span class="o">.</span><span class="n">append_data</span><span class="p">(</span><span class="n">nmr_data</span><span class="p">)</span>

<span class="n">proj</span><span class="o">.</span><span class="n">append_data</span><span class="p">(</span><span class="s1">&#39;https://drive.google.com/file/d/1U4mGNGyIEH9XNqDvI4qUWQZagPkwi7dx/view?usp=share_link&#39;</span><span class="p">)</span> <span class="c1">#Online link</span>
<span class="n">proj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDIFRATE project with 2 data sets
&lt;pyDR.Project.Project.Project object at 0x7fbce3607bb0&gt;

Titles:
r:NMR:HETs_15N
r:NMR:1U4mGNGyIE
</pre></div>
</div>
</div>
</div>
<p>The second way we get data into a project is by processing data already stored in a project</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">inclS2</span><span class="p">()</span>
<span class="n">proj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p5:NMR:HETs_15N with 49 data points
&lt;pyDR.Data.Data.Data object at 0x7fbce4129be0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDIFRATE project with 3 data sets
&lt;pyDR.Project.Project.Project object at 0x7fbce3607bb0&gt;

Titles:
r:NMR:HETs_15N
r:NMR:1U4mGNGyIE
p5:NMR:HETs_15N
</pre></div>
</div>
</div>
</div>
<p>As one sees, after processing the first data object in the project, we obtain a new data object– any new data created out of a project is automatically appended to it.</p>
<p>For MD data, we first create a selection object. The simplest way to get MD data to a project is to add the project to the original selection object, which will cause any data produced from that selection object to go automatically into the project. We may also use proj.append_data after the data creation if desired.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sel</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">MolSelect</span><span class="p">(</span><span class="n">topo</span><span class="o">=</span><span class="s1">&#39;pyDR/examples/HETs15N/backboneB.pdb&#39;</span><span class="p">,</span>
                   <span class="n">traj_files</span><span class="o">=</span><span class="s1">&#39;pyDR/examples/HETs15N/backboneB.xtc&#39;</span><span class="p">,</span>
                   <span class="n">project</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span> <span class="c1">#Create a selection object</span>
<span class="n">sel</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">step</span><span class="o">=</span><span class="mi">10</span> <span class="c1">#Adjust time step for faster loading</span>
<span class="n">pyDR</span><span class="o">.</span><span class="n">Defaults</span><span class="p">[</span><span class="s1">&#39;ProgressBar&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span>  <span class="c1">#Turn off progress bar for webpage</span>
<span class="n">sel</span><span class="o">.</span><span class="n">select_bond</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">segids</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">pyDR</span><span class="o">.</span><span class="n">md2data</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r:MD:backboneB with 70 data points
&lt;pyDR.Data.Data.Data object at 0x7fbcd0ed9e80&gt;
</pre></div>
</div>
</div>
</div>
<p>If we check, we find indeed that the raw data has now appeared in the project</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pyDIFRATE project with 4 data sets
&lt;pyDR.Project.Project.Project object at 0x7fbce3607bb0&gt;

Titles:
r:NMR:HETs_15N
r:NMR:1U4mGNGyIE
p5:NMR:HETs_15N
r:MD:backboneB
</pre></div>
</div>
</div>
</div>
<p>In the subsequent tutorials, we’ll also see how to generate data from the ROMANCE (frames) and cross-correlation (iRED) modules.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ch5_MDvsNMR.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><font color="maroon">Chapter 5: Comparing MD and NMR Results</font></p>
      </div>
    </a>
    <a class="right-next"
       href="Ch7_CCana.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><font color="maroon">Chapter 7: Cross-Correlated Dynamics via iRED</font></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data-object">The Data Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-in-the-data-object">Data in the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sensitivity-of-the-data-object">Sensitivity of the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detectors-for-the-data-object">Detectors for the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-results-in-the-data-object">Fitting results in the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-displays-in-the-data-object">Data displays in the data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selections-in-data-object">Selections in data object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-information-in-data-object">Source information in data object</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-project-object">The Project Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-data-selection">Project data selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-batch-processing">Project batch processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-plotting">Project plotting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chimerax-in-projects">ChimeraX in projects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-saving-loading">Project saving/loading</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-generation">Data Generation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Albert Smith, Kai Zumpfe
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>