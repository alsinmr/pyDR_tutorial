
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors &#8212; pyDIFRATE Tutorial</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 5: Comparing MD and NMR Results" href="Ch5_MDvsNMR.html" />
    <link rel="prev" title="Chapter 3: A Basic NMR Analysis" href="Ch3_basic_NMR.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">pyDIFRATE Tutorial</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the pyDIFRATE tutorial
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="GettingStarted.html">
   <font color="maroon">
    Getting Started
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BriefHistory.html">
   <font color="maroon">
    Background
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="References.html">
   <font color="maroon">
    References
   </font>
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorial
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Ch1_detectors_intro.html">
   <font color="maroon">
    Chapter 1: A brief introduction to detectors
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Ch2_detector_opt.html">
   <font color="maroon">
    Chapter 2: Detector Optimization
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Ch3_basic_NMR.html">
   <font color="maroon">
    Chapter 3: A Basic NMR Analysis
   </font>
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   <font color="maroon">
    Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Ch5_MDvsNMR.html">
   <font color="maroon">
    Chapter 5: Comparing MD and NMR Results
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Ch6_pyDRstruct.html">
   <font color="maroon">
    Chapter 6: Anatomy of pyDIFRATE
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Ch7_CCana.html">
   <font color="maroon">
    Chapter 7: Cross-Correlated Dynamics via iRED
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Ch8_ROMANCE_CH3.html">
   <font color="maroon">
    Chapter 8: ROMANCE Analysis of Methyl Groups
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Ch9_ROMANCE_backbone.html">
   <font color="maroon">
    Chapter 9: ROMANCE Analysis of Backbone Motion
   </font>
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Templates
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Tpl_basicNMR.html">
   <font color="maroon">
    Template: Basic NMR
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tpl_SolnNMR.html">
   <font color="maroon">
    Template: Solution-State NMR
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tpl_CCana.html">
   <font color="maroon">
    Template: Cross-Correlated Dynamics via iRED
   </font>
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/alsinmr/pyDR_tutorial/master?urlpath=tree/JupyterBook/Ch4_ComparingAnalyses.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/alsinmr/pyDR_tutorial/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/alsinmr/pyDR_tutorial//issues/new?title=Issue%20on%20page%20%2FCh4_ComparingAnalyses.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Ch4_ComparingAnalyses.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-plot-the-data">
     Load and plot the data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spectral-density-mapping">
   Spectral Density Mapping
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-sdm-results">
     Plot the SDM results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lemaster-s-approach">
   LeMaster’s Approach
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-results-from-lemaster-s-approach">
     Plot results from LeMaster’s Approach
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#impact-analysis-of-full-data-set">
   IMPACT Analysis of full data set
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-impact-amplitudes">
     Plot IMPACT amplitudes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-data-fit-resulting-from-impact-analysis">
     Plot data fit resulting from IMPACT analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-field-detector-analysis-first-without-removing-tumbling">
   One-field detector analysis, first without removing tumbling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-field-detector-analysis-including-removing-tumbling">
   One-field detector analysis, including removing tumbling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detector-analysis-of-full-data-set-without-removing-tumbling">
   Detector Analysis of full data set without removing tumbling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detector-analysis-of-full-data-set-including-removing-tumbling">
   Detector Analysis of full data set including removing tumbling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-free-analysis">
   Model Free Analysis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extended-model-free-analysis-of-full-data-set">
   Extended Model-free analysis of full data set
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-model-free-parameters">
     Plot the Model Free parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-fit-of-the-detector-responses">
     Plot the fit of the detector responses
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1><font color="maroon">Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors</font></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-plot-the-data">
     Load and plot the data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spectral-density-mapping">
   Spectral Density Mapping
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-sdm-results">
     Plot the SDM results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lemaster-s-approach">
   LeMaster’s Approach
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-results-from-lemaster-s-approach">
     Plot results from LeMaster’s Approach
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#impact-analysis-of-full-data-set">
   IMPACT Analysis of full data set
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-impact-amplitudes">
     Plot IMPACT amplitudes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-data-fit-resulting-from-impact-analysis">
     Plot data fit resulting from IMPACT analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-field-detector-analysis-first-without-removing-tumbling">
   One-field detector analysis, first without removing tumbling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-field-detector-analysis-including-removing-tumbling">
   One-field detector analysis, including removing tumbling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detector-analysis-of-full-data-set-without-removing-tumbling">
   Detector Analysis of full data set without removing tumbling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detector-analysis-of-full-data-set-including-removing-tumbling">
   Detector Analysis of full data set including removing tumbling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-free-analysis">
   Model Free Analysis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extended-model-free-analysis-of-full-data-set">
   Extended Model-free analysis of full data set
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-model-free-parameters">
     Plot the Model Free parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-fit-of-the-detector-responses">
     Plot the fit of the detector responses
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="font-color-maroon-chapter-4-comparison-of-model-free-sdm-lemaster-s-approach-and-detectors-font">
<h1><font color="maroon">Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors</font><a class="headerlink" href="#font-color-maroon-chapter-4-comparison-of-model-free-sdm-lemaster-s-approach-and-detectors-font" title="Permalink to this headline">#</a></h1>
<p><a href="https://githubtocolab.com/alsinmr/pyDR_tutorial/blob/main/ColabNotebooks/Ch4_ComparingAnalyses.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg"></a></p>
<p>The following analysis was originally prepared for the <a class="reference external" href="https://www.cidnp.net/summerschools">2023 Windischleuba NMR Summer School</a>.</p>
<p>In the following, we will load a data set consisting of <span class="math notranslate nohighlight">\(^{15}\)</span>N relaxation data acquired for ubiquitin in solution, and analyze it using five methods: Spectral Density Mapping, LeMaster’s Approach, IMPACT, Detector Analysis (with and without removing tumbling), and Model-Free Analysis.</p>
<p><strong>The data is taken from:</strong></p>
<p>C. Charlier, S.N. Khan, T. Arquardsen, P. Pelupessy, V. Reiss, D. Sakellariou, G. Bodenhausen, F. Engelke, F. Ferrage. “Nanosecond time scale motions in proteins revealed by high-resolution NMR relaxometry.” <a class="reference external" href="https://pubs.acs.org/doi/10.1021/ja409820g"><em>J. Am. Chem. Soc.</em> vol. 135, 18665-72 (2013)</a>.</p>
<p>(Thanks to Fabien for sharing!)</p>
<p><strong>The methods used are:</strong></p>
<p><em>Model-Free analysis</em></p>
<p>Lipari, G. &amp; Szabo, A. Model-free approach to the interpretation of nuclear magnetic resonance relaxation in macromolecules. 1. Theory and range of validity. <a class="reference external" href="https://pubs.acs.org/doi/10.1021/ja00381a009"><em>J. Am. Chem. Soc.</em> vol. 104 4546–4559 (1982)</a></p>
<p><em>Spectral Density Mapping</em></p>
<p>Peng, J. &amp; Wagner, G. Mapping of Spectral Density Functions Using Heteronuclear NMR Relaxation Measurements. <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/002223649290135T"><em>J. Magn. Res.</em> vol. 98 308–332 (1992)</a></p>
<p><em>LeMaster’s Approach</em></p>
<p>LeMaster, D. M. Larmor frequency selective model free analysis of protein NMR relaxation. <a class="reference external" href="https://link.springer.com/article/10.1007/BF00197636"><em>J. Biomol. NMR</em> vol. 6 366–374 (1995)</a></p>
<p><em>IMPACT</em></p>
<p>Khan, S.N., Charlier, C., Augustyniak, R., Salvi, N., Dejean, V., Bodenhausen, G., Lequin, O., Pelupessy, P., Ferrage, F. Distribution of Pico- and Nanosecond Motions in Disordered Proteins from Nuclear Spin Relaxation. <a class="reference external" href="https://doi.org/10.1016/j.bpj.2015.06.069"><em>Biophys. J.</em> vol. 109 988-99 (2015)</a></p>
<p><em>Detector Analysis</em></p>
<p>Smith, A. A., Ernst, M. &amp; Meier, B. H. Optimized ‘detectors’ for dynamics analysis in solid-state NMR. <a class="reference external" href="https://aip.scitation.org/doi/full/10.1063/1.5013316"><em>J. Chem. Phys.</em> vol. 148 045104 (2018)</a></p>
<p>Smith, A. A., Ernst, M., Meier, B. H. &amp; Ferrage, F. Reducing bias in the analysis of solution-state NMR data with dynamics detectors. <a class="reference external" href="https://aip.scitation.org/doi/full/10.1063/1.5111081"><em>J. Chem. Phys.</em> vol. 151 034102 (2019)</a></p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SETUP pyDR</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span> <span class="c1"># Path to pyDR location</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports, misc. setup</span>
<span class="kn">import</span> <span class="nn">pyDR</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">lsq_linear</span> <span class="k">as</span> <span class="n">lstsq</span>

<span class="n">pyDR</span><span class="o">.</span><span class="n">Defaults</span><span class="p">[</span><span class="s1">&#39;zrange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<section id="load-and-plot-the-data">
<h3>Load and plot the data<a class="headerlink" href="#load-and-plot-the-data" title="Permalink to this headline">#</a></h3>
<p>Note we split the data by field because Spectral Density Mapping (SDM) and LeMaster’s approach only operate on data from one field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load the data</span>
<span class="n">data</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readNMR</span><span class="p">(</span><span class="s1">&#39;data/ubi_soln.txt&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;med_val&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>

<span class="c1">#Split into one-field data for SDM, LeMaster&#39;s approach</span>
<span class="n">data600</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
<span class="n">data600</span><span class="o">.</span><span class="n">del_exp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="n">data800</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
<span class="n">data800</span><span class="o">.</span><span class="n">del_exp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">data950</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
<span class="n">data950</span><span class="o">.</span><span class="n">del_exp</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>

<span class="n">cm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;tab10&#39;</span><span class="p">)</span>  <span class="c1">#Color map (use for selecting colors)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$R_1$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\Gamma_</span><span class="si">{HN}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$R_2$&#39;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">950</span><span class="p">]:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">k</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">exp</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39; / s$^{-1}$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">.7</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\nu(^1H)$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; MHz&#39;</span><span class="p">)</span>
        <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/Ch4_ComparingAnalyses_7_1.png" src="_images/Ch4_ComparingAnalyses_7_1.png" />
</div>
</div>
</section>
</section>
<section id="spectral-density-mapping">
<h2>Spectral Density Mapping<a class="headerlink" href="#spectral-density-mapping" title="Permalink to this headline">#</a></h2>
<p>Spectral density mapping is achieved simply by calculating linear combinations of the experimental relaxation rate constants at one field, as follows:
\begin{eqnarray}
J(0)&amp;=&amp;\frac{R_2-R_1/2-0.454\sigma_\mathrm{IS}}{\delta_\mathrm{IS}^2/2+2(\Delta\sigma_\mathrm{I}\omega_\mathrm{I})^2} \
J(\omega_\mathrm{I})&amp;=&amp;\frac{R_1-1.249\sigma_\mathrm{IS}}{3(\delta_\mathrm{IS}/4)^2+(\Delta\sigma_\mathrm{I}\omega_\mathrm{I})^2/3} \
J(0.870\omega_\mathrm{S})&amp;=&amp;\frac{16\sigma_\mathrm{IS}}{5\delta_\mathrm{IS}^2}
\end{eqnarray}</p>
<p>This results in the following windows, resulting from the spectral density calculated for a given value of <span class="math notranslate nohighlight">\(\tau_c\)</span> and <span class="math notranslate nohighlight">\((1–S^2)=1\)</span>.
\begin{equation}
J(\omega,\tau_c)=\frac25\frac{\tau_c}{1+(\omega\tau_c)^2}
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">J</span><span class="o">=</span><span class="k">lambda</span> <span class="n">omega</span><span class="p">,</span><span class="n">tc</span><span class="p">:</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">tc</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">titles</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$J(0)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$J(\omega_</span><span class="si">{N}</span><span class="s1">)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$J(0.870*\omega_</span><span class="si">{H}</span><span class="s1">)$&#39;</span><span class="p">)</span>

<span class="n">v0H0</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">950</span><span class="p">]</span>
<span class="n">rat</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">NucInfo</span><span class="p">(</span><span class="s1">&#39;15N&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">pyDR</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">NucInfo</span><span class="p">(</span><span class="s1">&#39;1H&#39;</span><span class="p">)</span> <span class="c1">#Ratio of 15N to 1H Larmor frequency</span>
<span class="n">tc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v0H</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">v0H0</span><span class="p">,</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">J</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tc</span><span class="p">))</span>
    <span class="n">a</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">J</span><span class="p">(</span><span class="n">v0H</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="n">tc</span><span class="p">))</span>
    <span class="n">a</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">J</span><span class="p">(</span><span class="n">v0H</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.87</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="n">tc</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">is_first_col</span><span class="p">():</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$J(\omega)$ / s&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.75e-9</span><span class="p">])</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau_c$&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1$H)&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39; = </span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Ch4_ComparingAnalyses_9_0.png" src="_images/Ch4_ComparingAnalyses_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;From the rotational correlation time, 4.84e-9 s, we estimate J(0) should be slightly less than </span><span class="si">{</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="mf">4.84e-9</span><span class="si">}</span><span class="s1"> s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>From the rotational correlation time, 4.84e-9 s, we estimate J(0) should be slightly less than 1.936e-09 s
</pre></div>
</div>
</div>
</div>
<section id="plot-the-sdm-results">
<h3>Plot the SDM results<a class="headerlink" href="#plot-the-sdm-results" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>

<span class="n">titles</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$J(0)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$J(\omega_</span><span class="si">{N}</span><span class="s1">)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$J(0.870*\omega_</span><span class="si">{H}</span><span class="s1">)$&#39;</span><span class="p">)</span>

<span class="n">delta</span><span class="o">=</span><span class="mi">22954</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>  <span class="c1">#rad/s</span>
<span class="n">Del_sig</span><span class="o">=</span><span class="mi">172</span>   <span class="c1">#ppm</span>

<span class="n">J0</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
<span class="n">JomegaI</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
<span class="n">Jp87omegaS</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">v0H</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">v0H0</span><span class="p">,[</span><span class="n">data600</span><span class="p">,</span><span class="n">data800</span><span class="p">,</span><span class="n">data950</span><span class="p">],</span><span class="n">ax</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
    <span class="c1">#data in d has residues down the columns and R1,NOE,R2 across the rows</span>
    <span class="n">DSOmega</span><span class="o">=</span><span class="n">Del_sig</span><span class="o">*</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>   <span class="c1">#DeltaSigma_I*omega_I  (rad/s)</span>
    <span class="n">dd</span><span class="o">=</span><span class="n">delta</span>
    <span class="n">c</span><span class="o">=</span><span class="n">Del_sig</span><span class="o">*</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">J0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mf">0.454</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">dd</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">JomegaI</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1.249</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">dd</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">Jp87omegaS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">dd</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">J</span><span class="p">,</span><span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">Jp87omegaS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">JomegaI</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">J0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">titles</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">J</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">title</span><span class="o">+</span><span class="s1">&#39; / 1e-9 s&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">is_first_row</span><span class="p">():</span>
            <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1H)$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39; = </span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.03</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.5</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Ch4_ComparingAnalyses_12_0.png" src="_images/Ch4_ComparingAnalyses_12_0.png" />
</div>
</div>
<p>Note that the spike in <span class="math notranslate nohighlight">\(J(0)\)</span> at residues 21-23 is likely due to chemical exchange, and is not due to reorientional dynamics.</p>
</section>
</section>
<section id="lemaster-s-approach">
<h2>LeMaster’s Approach<a class="headerlink" href="#lemaster-s-approach" title="Permalink to this headline">#</a></h2>
<p>LeMaster uses a similar approach, but fits the data to a model spectral density, which allows one to separate out the influence of tumbling from the internal motion.
\begin{eqnarray}
J(\omega)=
&amp;\frac25&amp;\left[\frac{\tau_M}{1+(\omega\tau_M)^2}+(1-S_f^2)\left(-\frac{\tau_M}{1+(\omega\tau_M)^2}\right)+\right.\
&amp;&amp;\left.S_f^2(1-S_H^2)\left(\frac{\tau_H}{1+(\omega\tau_H)^2}-\frac{\tau_M}{1+(\omega\tau_M)^2}\right)+S_f^2S_H^2(1-S_N^2)\left(\frac{\tau_N}{1+(\omega\tau_N)^2}-\frac{\tau_M}{1+(\omega\tau_M)^2}\right)\right]
\end{eqnarray}
with
\begin{eqnarray}
\tau_H&amp;=&amp;(\omega_H+\omega_N)^{-1} \
\tau_N&amp;=&amp;|\omega_N|^{-1}
\end{eqnarray}
Then, the parameters <span class="math notranslate nohighlight">\(1-S_f^2\)</span>, <span class="math notranslate nohighlight">\(S_f^2(1-S_H^2)\)</span>, and <span class="math notranslate nohighlight">\(S_f^2S_H^2(1-S_N^2)\)</span> can be used to fit the relaxation rate constants or the spectral densities directly in a linear fit.</p>
<p>We’ll use the results from the SDM, rather than trying to do the fits directly from the raw data.</p>
<p>We know from previously published results (Charlier et al.) that the rotational correlation time, <span class="math notranslate nohighlight">\(\tau_M\)</span>, is 4.84 ns</p>
<section id="plot-results-from-lemaster-s-approach">
<h3>Plot results from LeMaster’s Approach<a class="headerlink" href="#plot-results-from-lemaster-s-approach" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>

<span class="n">tM</span><span class="o">=</span><span class="mf">4.84e-9</span>  <span class="c1">#Rotation diffusion correlation time / s</span>

<span class="n">titles</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$1-S_f^2$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$S_f^2(1-S_H^2)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$S_f^2S_H^2(1-S_N^2)$&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">v0H</span><span class="p">,</span><span class="n">J00</span><span class="p">,</span><span class="n">JomegaI0</span><span class="p">,</span><span class="n">Jp87omegaS0</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">v0H0</span><span class="p">,</span><span class="n">J0</span><span class="p">,</span><span class="n">JomegaI</span><span class="p">,</span><span class="n">Jp87omegaS</span><span class="p">,</span><span class="n">ax</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
    <span class="n">tH</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">v0H</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="o">+</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span>
    <span class="n">tN</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span>
        
    <span class="n">omega0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="mf">0.87</span><span class="o">*</span><span class="n">v0H</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">]</span>  <span class="c1">#Frequencies sampled by SDM in rad/s</span>
    
    <span class="n">offset</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1">#This is the offset term, 2/5*tM/(1+omega*tM)</span>
    <span class="n">M</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">omega</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">omega0</span><span class="p">):</span>
        <span class="n">offset</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">tM</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tM</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#M@[(1-Sf2),Sf2*(1-SH2),Sf2*SH2*(1-SN2)] = [J0,JomegaN,0.87*JomegaH]</span>
        <span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">tM</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tM</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">tH</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tH</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">tM</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tM</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
              <span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">tN</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tN</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">tM</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tM</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))]</span>
    
    <span class="n">A0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">@</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">J00</span><span class="p">,</span><span class="n">JomegaI0</span><span class="p">,</span><span class="n">Jp87omegaS0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">offset</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#     A0=np.array([lsq(M,b)[&#39;x&#39;] for b in np.array([J00,JomegaI0,Jp87omegaS0]).T-offset]).T</span>
    
    <span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">A</span><span class="p">,</span><span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="n">titles</span><span class="p">)):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">is_first_row</span><span class="p">():</span>
            <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1H)$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39; = </span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
       
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Ch4_ComparingAnalyses_16_0.png" src="_images/Ch4_ComparingAnalyses_16_0.png" />
</div>
</div>
</section>
</section>
<section id="impact-analysis-of-full-data-set">
<h2>IMPACT Analysis of full data set<a class="headerlink" href="#impact-analysis-of-full-data-set" title="Permalink to this headline">#</a></h2>
<p>IMPACT assumes a correlation function which is a sum of several correlation times, where the sum of weights for the terms is 1. We will assume four correlation times here, such that
\begin{eqnarray}
C(t)&amp;=&amp;\frac25\sum\limits_{i=1}^4{A_ie^{-t/\tau_i}} \
1&amp;=&amp;\sum\limits_{i=1}^4{A_i} \
0&amp;\le&amp;A_i\le1
\end{eqnarray}</p>
<section id="plot-impact-amplitudes">
<h3>Plot IMPACT amplitudes<a class="headerlink" href="#plot-impact-amplitudes" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#I cheated a little bit here...</span>
<span class="c1">#I took the correlation times from the detector analysis below for the middle 3 values</span>
<span class="c1">#And then manually optimized the last and put the first to just a short correlation time</span>
<span class="n">tau</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mf">9.9002036</span><span class="p">,</span><span class="o">-</span><span class="mf">9.2239323</span><span class="p">,</span><span class="o">-</span><span class="mf">8.5449795</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">])</span> <span class="c1">#Array of correlation times</span>
<span class="n">J</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">*</span><span class="n">J0</span><span class="p">,</span><span class="o">*</span><span class="n">JomegaI</span><span class="p">,</span><span class="o">*</span><span class="n">Jp87omegaS</span><span class="p">])</span> <span class="c1">#Collect all spectra densities</span>
<span class="n">norm</span><span class="o">=</span><span class="n">J</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#Use for reweighting</span>
<span class="n">omega</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">rat</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v0H0</span><span class="p">)),</span><span class="o">*</span><span class="p">(</span><span class="mf">0.87</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v0H0</span><span class="p">))])</span><span class="o">*</span><span class="mf">1e6</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="n">q</span><span class="o">=</span><span class="mi">10</span>

<span class="n">M</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tau</span><span class="p">)])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">tau0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tau</span><span class="p">):</span>
    <span class="n">M</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">tau0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tau0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span>
    <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">q</span>  <span class="c1">#We&#39;ll use this position to enforce the sum of the Ai to 1</span>

<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tau</span><span class="p">),</span><span class="n">J</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">Jc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">X</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
    <span class="n">target</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="o">/</span><span class="n">norm</span><span class="p">),</span><span class="n">q</span><span class="p">])</span>
    <span class="n">out</span><span class="o">=</span><span class="n">lstsq</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">A</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="n">Jc</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="nd">@A</span><span class="p">[:,</span><span class="n">k</span><span class="p">])[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">norm</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tau</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">a</span><span class="p">,</span><span class="n">A0</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">A</span><span class="p">)):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$A_{&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;}$&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">.7</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\tau_{&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;=</span><span class="si">{</span><span class="n">tau</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">()):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;IMPACT analysis&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;IMPACT analysis&#39;)
</pre></div>
</div>
<img alt="_images/Ch4_ComparingAnalyses_19_1.png" src="_images/Ch4_ComparingAnalyses_19_1.png" />
</div>
</div>
</section>
<section id="plot-data-fit-resulting-from-impact-analysis">
<h3>Plot data fit resulting from IMPACT analysis<a class="headerlink" href="#plot-data-fit-resulting-from-impact-analysis" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">a</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Xc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">J</span><span class="p">,</span><span class="n">Jc</span><span class="p">)):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="o">//</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">Xc</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$J(\omega)$&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Data Fit&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Data Fit&#39;)
</pre></div>
</div>
<img alt="_images/Ch4_ComparingAnalyses_21_1.png" src="_images/Ch4_ComparingAnalyses_21_1.png" />
</div>
</div>
</section>
</section>
<section id="one-field-detector-analysis-first-without-removing-tumbling">
<h2>One-field detector analysis, first without removing tumbling<a class="headerlink" href="#one-field-detector-analysis-first-without-removing-tumbling" title="Permalink to this headline">#</a></h2>
<p>Detector analysis can be performed on the total motion, which means for solution-state data, the overall tumbling is included in the detector responses. We do this analysis first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_sens</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">d</span><span class="p">,</span><span class="n">v0H</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">data600</span><span class="p">,</span><span class="n">data800</span><span class="p">,</span><span class="n">data950</span><span class="p">],</span><span class="n">v0H0</span><span class="p">,</span><span class="n">ax</span><span class="o">.</span><span class="n">T</span><span class="p">)):</span>
    <span class="c1">#When loaded, a &quot;solution-state&quot; sensitivity is loaded, and includes tumbling influence</span>
    <span class="c1">#For the initial analysis, we replace this with a sensitivity that does not consider tumbling</span>
    <span class="n">d</span><span class="o">.</span><span class="n">sens</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">fit</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fit</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_sens</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">fit</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">m</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;^{(\theta,S)}$&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.4</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.8</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.007</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1H) = $&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/Ch4_ComparingAnalyses_23_3.png" src="_images/Ch4_ComparingAnalyses_23_3.png" />
<img alt="_images/Ch4_ComparingAnalyses_23_4.png" src="_images/Ch4_ComparingAnalyses_23_4.png" />
</div>
</div>
</section>
<section id="one-field-detector-analysis-including-removing-tumbling">
<h2>One-field detector analysis, including removing tumbling<a class="headerlink" href="#one-field-detector-analysis-including-removing-tumbling" title="Permalink to this headline">#</a></h2>
<p>We may also factor out isotropic tumbling, which is the case for sufficiently spherical molecules, so that detector responses represent only the internal motion. Note that this has a profound effect on the positioning of the detector windows, as discussed <a class="reference external" href="https://aip.scitation.org/doi/full/10.1063/1.5111081">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_sens</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">d</span><span class="p">,</span><span class="n">v0H</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">data600</span><span class="p">,</span><span class="n">data800</span><span class="p">,</span><span class="n">data950</span><span class="p">],</span><span class="n">v0H0</span><span class="p">,</span><span class="n">ax</span><span class="o">.</span><span class="n">T</span><span class="p">)):</span>
    <span class="c1">#When loaded, a &quot;solution-state&quot; sensitivity is loaded, and includes tumbling influence</span>
    <span class="c1">#For the initial analysis, we replace this with a sensitivity that does not consider tumbling</span>
    <span class="n">d</span><span class="o">.</span><span class="n">sens</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">SolnNMR</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">fit</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fit</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_sens</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">fit</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">m</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;^{(\theta,S)}$&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1H) = $&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/Ch4_ComparingAnalyses_25_3.png" src="_images/Ch4_ComparingAnalyses_25_3.png" />
<img alt="_images/Ch4_ComparingAnalyses_25_4.png" src="_images/Ch4_ComparingAnalyses_25_4.png" />
</div>
</div>
</section>
<section id="detector-analysis-of-full-data-set-without-removing-tumbling">
<h2>Detector Analysis of full data set without removing tumbling<a class="headerlink" href="#detector-analysis-of-full-data-set-without-removing-tumbling" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mf">7.9</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="n">info</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">S2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">S2std</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.01</span>
<span class="n">data</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">fit</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">plt_obj</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">plt_obj</span><span class="o">.</span><span class="n">ax</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">show_tc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/Ch4_ComparingAnalyses_27_1.png" src="_images/Ch4_ComparingAnalyses_27_1.png" />
</div>
</div>
</section>
<section id="detector-analysis-of-full-data-set-including-removing-tumbling">
<h2>Detector Analysis of full data set including removing tumbling<a class="headerlink" href="#detector-analysis-of-full-data-set-including-removing-tumbling" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zmax</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">*</span><span class="n">fit</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">SolnNMR</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">fit</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">plt_obj</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span><span class="n">errorbars</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">show_tc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/Ch4_ComparingAnalyses_29_1.png" src="_images/Ch4_ComparingAnalyses_29_1.png" />
</div>
</div>
</section>
<section id="model-free-analysis">
<h2>Model Free Analysis<a class="headerlink" href="#model-free-analysis" title="Permalink to this headline">#</a></h2>
<p>In this analysis, we fit the internal motion of ubiquitin to a single correlation time, i.e. via the simple model free approach. Note that this is actually easier done to the results of the detector analysis rather than to the raw NMR data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyDR.Fitting.fit</span> <span class="kn">import</span> <span class="n">model_free</span>
<span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">error</span><span class="p">,</span><span class="n">dfit</span><span class="o">=</span><span class="n">model_free</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">nz</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt_obj</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">append_data</span><span class="p">(</span><span class="n">dfit</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">ax_sens</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Detector Responses back-calculated from MF vs original&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$1-S_f^2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z_f=\log(\tau_f$/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simple Model-Free Analysis of Detectors&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 of 1 iterations
</pre></div>
</div>
<img alt="_images/Ch4_ComparingAnalyses_31_1.png" src="_images/Ch4_ComparingAnalyses_31_1.png" />
<img alt="_images/Ch4_ComparingAnalyses_31_2.png" src="_images/Ch4_ComparingAnalyses_31_2.png" />
</div>
</div>
</section>
<section id="extended-model-free-analysis-of-full-data-set">
<h2>Extended Model-free analysis of full data set<a class="headerlink" href="#extended-model-free-analysis-of-full-data-set" title="Permalink to this headline">#</a></h2>
<p>Finally, we use an extended model free analyis. Note that for extended model free analysis, one would typically do a residue-specific model selection, where the number of free parameters is variable (correlation times, order parameters). We do not do that here, always fitting to 2 correlation times and two amplitudes</p>
<section id="plot-the-model-free-parameters">
<h3>Plot the Model Free parameters<a class="headerlink" href="#plot-the-model-free-parameters" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyDR.Fitting.fit</span> <span class="kn">import</span> <span class="n">model_free</span>
<span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">error</span><span class="p">,</span><span class="n">dfit</span><span class="o">=</span><span class="n">model_free</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">nz</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$1-S_f^2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z_f=\log(\tau_f$/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$S_f^2(1-S_s^2)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z_s=\log(\tau_s$/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Extended Model-Free Analysis of Detectors&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 of 4 iterations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 of 4 iterations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 of 4 iterations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4 of 4 iterations
</pre></div>
</div>
<img alt="_images/Ch4_ComparingAnalyses_34_4.png" src="_images/Ch4_ComparingAnalyses_34_4.png" />
</div>
</div>
</section>
<section id="plot-the-fit-of-the-detector-responses">
<h3>Plot the fit of the detector responses<a class="headerlink" href="#plot-the-fit-of-the-detector-responses" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt_obj</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">append_data</span><span class="p">(</span><span class="n">dfit</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">ax_sens</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Detector Responses back-calculated from MF vs original&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Ch4_ComparingAnalyses_36_0.png" src="_images/Ch4_ComparingAnalyses_36_0.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Ch3_basic_NMR.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><font color="maroon">Chapter 3: A Basic NMR Analysis</font></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Ch5_MDvsNMR.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><font color="maroon">Chapter 5: Comparing MD and NMR Results</font></p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Albert Smith<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>