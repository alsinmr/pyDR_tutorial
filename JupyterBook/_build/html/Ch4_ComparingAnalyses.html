
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors &#8212; pyDIFRATE Tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ch4_ComparingAnalyses';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 5: Comparing MD and NMR Results" href="Ch5_MDvsNMR.html" />
    <link rel="prev" title="Chapter 3: A Basic NMR Analysis" href="Ch3_basic_NMR.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="pyDIFRATE Tutorial - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="pyDIFRATE Tutorial - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the pyDIFRATE tutorial
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html"><font color="maroon">Getting Started</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="BriefHistory.html"><font color="maroon"> Background </font></a></li>
<li class="toctree-l1"><a class="reference internal" href="References.html"><font color="maroon"> References </font></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Ch1_detectors_intro.html"><font color="maroon"> Chapter 1: A brief introduction to detectors </font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch2_detector_opt.html"><font color="maroon">Chapter 2: Detector Optimization</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch3_basic_NMR.html"><font color="maroon">Chapter 3: A Basic NMR Analysis</font></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><font color="maroon">Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch5_MDvsNMR.html"><font color="maroon">Chapter 5: Comparing MD and NMR Results</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch6_pyDRstruct.html"><font color="maroon">Chapter 6: Anatomy of pyDIFRATE</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch7_CCana.html"><font color="maroon">Chapter 7: Cross-Correlated Dynamics via iRED</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Ch8_ROMANCE_backbone.html"><font color="maroon">Chapter 8: ROMANCE Analysis of Backbone Motion</font></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Templates</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tpl_blank.html"><font color="maroon">Template: pyDR Setup</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tpl_basicNMR.html"><font color="maroon">Template: Basic NMR</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tpl_SolnNMR.html"><font color="maroon">Template: Solution-State NMR</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tpl_CCana.html"><font color="maroon">Template: Cross-Correlated Dynamics via iRED</font></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/alsinmr/pyDR_tutorial" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/alsinmr/pyDR_tutorial/issues/new?title=Issue%20on%20page%20%2FCh4_ComparingAnalyses.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Ch4_ComparingAnalyses.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><font color="maroon">Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors</font></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-plot-the-data">Load and plot the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-density-mapping">Spectral Density Mapping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-sdm-results">Plot the SDM results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lemaster-s-approach">LeMaster’s Approach</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-results-from-lemaster-s-approach">Plot results from LeMaster’s Approach</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-analysis-of-full-data-set">IMPACT Analysis of full data set</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-impact-amplitudes">Plot IMPACT amplitudes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data-fit-resulting-from-impact-analysis">Plot data fit resulting from IMPACT analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-field-detector-analysis-first-without-removing-tumbling">One-field detector analysis, first without removing tumbling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-field-detector-analysis-including-removing-tumbling">One-field detector analysis, including removing tumbling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detector-analysis-of-full-data-set-without-removing-tumbling">Detector Analysis of full data set without removing tumbling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detector-analysis-of-full-data-set-including-removing-tumbling">Detector Analysis of full data set including removing tumbling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-free-analysis">Model Free Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-model-free-analysis-of-full-data-set">Extended Model-free analysis of full data set</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-model-free-parameters">Plot the Model Free parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-fit-of-the-detector-responses">Plot the fit of the detector responses</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-4-comparison-of-model-free-sdm-lemaster-s-approach-and-detectors">
<h1><font color="maroon">Chapter 4: Comparison of Model-Free, SDM, LeMaster’s Approach, and Detectors</font><a class="headerlink" href="#chapter-4-comparison-of-model-free-sdm-lemaster-s-approach-and-detectors" title="Link to this heading">#</a></h1>
<p><a href="https://githubtocolab.com/alsinmr/pyDR_tutorial/blob/main/ColabNotebooks/Ch4_ComparingAnalyses.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg"></a></p>
<p>The following analysis was originally prepared for the <a class="reference external" href="https://www.cidnp.net/summerschools">2023 Windischleuba NMR Summer School</a>.</p>
<p>In the following, we will load a data set consisting of <span class="math notranslate nohighlight">\(^{15}\)</span>N relaxation data acquired for ubiquitin in solution, and analyze it using five methods: Spectral Density Mapping, LeMaster’s Approach, IMPACT, Detector Analysis (with and without removing tumbling), and Model-Free Analysis.</p>
<p><strong>The data is taken from:</strong></p>
<p>C. Charlier, S.N. Khan, T. Arquardsen, P. Pelupessy, V. Reiss, D. Sakellariou, G. Bodenhausen, F. Engelke, F. Ferrage. “Nanosecond time scale motions in proteins revealed by high-resolution NMR relaxometry.” <a class="reference external" href="https://pubs.acs.org/doi/10.1021/ja409820g"><em>J. Am. Chem. Soc.</em> vol. 135, 18665-72 (2013)</a>.</p>
<p>(Thanks to Fabien for sharing!)</p>
<p><strong>The methods used are:</strong></p>
<p><em>Model-Free analysis</em></p>
<p>Lipari, G. &amp; Szabo, A. Model-free approach to the interpretation of nuclear magnetic resonance relaxation in macromolecules. 1. Theory and range of validity. <a class="reference external" href="https://pubs.acs.org/doi/10.1021/ja00381a009"><em>J. Am. Chem. Soc.</em> vol. 104 4546–4559 (1982)</a></p>
<p><em>Spectral Density Mapping</em></p>
<p>Peng, J. &amp; Wagner, G. Mapping of Spectral Density Functions Using Heteronuclear NMR Relaxation Measurements. <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/002223649290135T"><em>J. Magn. Res.</em> vol. 98 308–332 (1992)</a></p>
<p><em>LeMaster’s Approach</em></p>
<p>LeMaster, D. M. Larmor frequency selective model free analysis of protein NMR relaxation. <a class="reference external" href="https://link.springer.com/article/10.1007/BF00197636"><em>J. Biomol. NMR</em> vol. 6 366–374 (1995)</a></p>
<p><em>IMPACT</em></p>
<p>Khan, S.N., Charlier, C., Augustyniak, R., Salvi, N., Dejean, V., Bodenhausen, G., Lequin, O., Pelupessy, P., Ferrage, F. Distribution of Pico- and Nanosecond Motions in Disordered Proteins from Nuclear Spin Relaxation. <a class="reference external" href="https://doi.org/10.1016/j.bpj.2015.06.069"><em>Biophys. J.</em> vol. 109 988-99 (2015)</a></p>
<p><em>Detector Analysis</em></p>
<p>Smith, A. A., Ernst, M. &amp; Meier, B. H. Optimized ‘detectors’ for dynamics analysis in solid-state NMR. <a class="reference external" href="https://aip.scitation.org/doi/full/10.1063/1.5013316"><em>J. Chem. Phys.</em> vol. 148 045104 (2018)</a></p>
<p>Smith, A. A., Ernst, M., Meier, B. H. &amp; Ferrage, F. Reducing bias in the analysis of solution-state NMR data with dynamics detectors. <a class="reference external" href="https://aip.scitation.org/doi/full/10.1063/1.5111081"><em>J. Chem. Phys.</em> vol. 151 034102 (2019)</a></p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SETUP pyDR</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;../..&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports, misc. setup</span>
<span class="kn">import</span> <span class="nn">pyDR</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">lsq_linear</span> <span class="k">as</span> <span class="n">lstsq</span>

<span class="n">pyDR</span><span class="o">.</span><span class="n">Defaults</span><span class="p">[</span><span class="s1">&#39;zrange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<section id="load-and-plot-the-data">
<h3>Load and plot the data<a class="headerlink" href="#load-and-plot-the-data" title="Link to this heading">#</a></h3>
<p>Note we split the data by field because Spectral Density Mapping (SDM) and LeMaster’s approach only operate on data from one field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load the data</span>
<span class="n">data</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readNMR</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/alsinmr/pyDR_tutorial/main/data/ubi_soln.txt&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;med_val&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>

<span class="c1">#Split into one-field data for SDM, LeMaster&#39;s approach</span>
<span class="n">data600</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
<span class="n">data600</span><span class="o">.</span><span class="n">del_exp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="n">data800</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
<span class="n">data800</span><span class="o">.</span><span class="n">del_exp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">data950</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
<span class="n">data950</span><span class="o">.</span><span class="n">del_exp</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>

<span class="n">cm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;tab10&#39;</span><span class="p">)</span>  <span class="c1">#Color map (use for selecting colors)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$R_1$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\Gamma_</span><span class="si">{HN}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$R_2$&#39;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">950</span><span class="p">]:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">k</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">exp</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39; / s$^{-1}$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">.7</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\nu(^1H)$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; MHz&#39;</span><span class="p">)</span>
        <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/9eda7b45aeaa497401edcee9379550e8b8fd045e3f7df672969d12c3e194ee5e.png" src="_images/9eda7b45aeaa497401edcee9379550e8b8fd045e3f7df672969d12c3e194ee5e.png" />
</div>
</div>
</section>
</section>
<section id="spectral-density-mapping">
<h2>Spectral Density Mapping<a class="headerlink" href="#spectral-density-mapping" title="Link to this heading">#</a></h2>
<p>Spectral density mapping is achieved simply by calculating linear combinations of the experimental relaxation rate constants at one field, as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
J(0)&amp;=&amp;\frac{R_2-R_1/2-0.454\sigma_\mathrm{IS}}{\delta_\mathrm{IS}^2/2+2(\Delta\sigma_\mathrm{I}\omega_\mathrm{I})^2} \\
J(\omega_\mathrm{I})&amp;=&amp;\frac{R_1-1.249\sigma_\mathrm{IS}}{3(\delta_\mathrm{IS}/4)^2+(\Delta\sigma_\mathrm{I}\omega_\mathrm{I})^2/3} \\
J(0.870\omega_\mathrm{S})&amp;=&amp;\frac{16\sigma_\mathrm{IS}}{5\delta_\mathrm{IS}^2}
\end{eqnarray}
\end{split}\]</div>
<p>This results in the following windows, resulting from the spectral density calculated for a given value of <span class="math notranslate nohighlight">\(\tau_c\)</span> and <span class="math notranslate nohighlight">\((1–S^2)=1\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
J(\omega,\tau_c)=\frac25\frac{\tau_c}{1+(\omega\tau_c)^2}
\end{equation}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">J</span><span class="o">=</span><span class="k">lambda</span> <span class="n">omega</span><span class="p">,</span><span class="n">tc</span><span class="p">:</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">tc</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">titles</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$J(0)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$J(\omega_</span><span class="si">{N}</span><span class="s1">)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$J(0.870*\omega_</span><span class="si">{H}</span><span class="s1">)$&#39;</span><span class="p">)</span>

<span class="n">v0H0</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">950</span><span class="p">]</span>
<span class="n">rat</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">NucInfo</span><span class="p">(</span><span class="s1">&#39;15N&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">pyDR</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">NucInfo</span><span class="p">(</span><span class="s1">&#39;1H&#39;</span><span class="p">)</span> <span class="c1">#Ratio of 15N to 1H Larmor frequency</span>
<span class="n">tc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v0H</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">v0H0</span><span class="p">,</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">J</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tc</span><span class="p">))</span>
    <span class="n">a</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">J</span><span class="p">(</span><span class="n">v0H</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="n">tc</span><span class="p">))</span>
    <span class="n">a</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">J</span><span class="p">(</span><span class="n">v0H</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.87</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="n">tc</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">is_first_col</span><span class="p">():</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$J(\omega)$ / s&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.75e-9</span><span class="p">])</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau_c$&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1$H)&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39; = </span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0ac71cf05b7066c678f3753664cc38ef7778597114353493f33bbdf9f8717f60.png" src="_images/0ac71cf05b7066c678f3753664cc38ef7778597114353493f33bbdf9f8717f60.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;From the rotational correlation time, 4.84e-9 s, we estimate J(0) should be slightly less than </span><span class="si">{</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="mf">4.84e-9</span><span class="si">}</span><span class="s1"> s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>From the rotational correlation time, 4.84e-9 s, we estimate J(0) should be slightly less than 1.936e-09 s
</pre></div>
</div>
</div>
</div>
<section id="plot-the-sdm-results">
<h3>Plot the SDM results<a class="headerlink" href="#plot-the-sdm-results" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>

<span class="n">titles</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$J(0)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$J(\omega_</span><span class="si">{N}</span><span class="s1">)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$J(0.870*\omega_</span><span class="si">{H}</span><span class="s1">)$&#39;</span><span class="p">)</span>

<span class="n">delta</span><span class="o">=</span><span class="mi">22954</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>  <span class="c1">#rad/s</span>
<span class="n">Del_sig</span><span class="o">=</span><span class="mi">172</span>   <span class="c1">#ppm</span>

<span class="n">J0</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
<span class="n">JomegaI</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
<span class="n">Jp87omegaS</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">v0H</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">v0H0</span><span class="p">,[</span><span class="n">data600</span><span class="p">,</span><span class="n">data800</span><span class="p">,</span><span class="n">data950</span><span class="p">],</span><span class="n">ax</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
    <span class="c1">#data in d has residues down the columns and R1,NOE,R2 across the rows</span>
    <span class="n">DSOmega</span><span class="o">=</span><span class="n">Del_sig</span><span class="o">*</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>   <span class="c1">#DeltaSigma_I*omega_I  (rad/s)</span>
    <span class="n">dd</span><span class="o">=</span><span class="n">delta</span>
    <span class="n">c</span><span class="o">=</span><span class="n">Del_sig</span><span class="o">*</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">J0</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mf">0.454</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">dd</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">JomegaI</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1.249</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">dd</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">Jp87omegaS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">dd</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">J</span><span class="p">,</span><span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">Jp87omegaS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">JomegaI</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">J0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">titles</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">J</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">title</span><span class="o">+</span><span class="s1">&#39; / 1e-9 s&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">is_first_row</span><span class="p">():</span>
            <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1H)$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39; = </span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.03</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.5</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/87474c75d8cd2201aec262b8dba41c9b4fd9eaeccc1788853b23478f14314dfc.png" src="_images/87474c75d8cd2201aec262b8dba41c9b4fd9eaeccc1788853b23478f14314dfc.png" />
</div>
</div>
<p>Note that the spike in <span class="math notranslate nohighlight">\(J(0)\)</span> at residues 21-23 is likely due to chemical exchange, and is not due to reorientional dynamics.</p>
</section>
</section>
<section id="lemaster-s-approach">
<h2>LeMaster’s Approach<a class="headerlink" href="#lemaster-s-approach" title="Link to this heading">#</a></h2>
<p>LeMaster uses a similar approach, but fits the data to a model spectral density, which allows one to separate out the influence of tumbling from the internal motion.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
J(\omega)=
&amp;\frac25&amp;\left[\frac{\tau_M}{1+(\omega\tau_M)^2}+(1-S_f^2)\left(-\frac{\tau_M}{1+(\omega\tau_M)^2}\right)+\right.\\
&amp;&amp;\left.S_f^2(1-S_H^2)\left(\frac{\tau_H}{1+(\omega\tau_H)^2}-\frac{\tau_M}{1+(\omega\tau_M)^2}\right)+S_f^2S_H^2(1-S_N^2)\left(\frac{\tau_N}{1+(\omega\tau_N)^2}-\frac{\tau_M}{1+(\omega\tau_M)^2}\right)\right]
\end{eqnarray}
\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\tau_H&amp;=&amp;(\omega_H+\omega_N)^{-1} \\
\tau_N&amp;=&amp;|\omega_N|^{-1}
\end{eqnarray}
\end{split}\]</div>
<p>Then, the parameters <span class="math notranslate nohighlight">\(1-S_f^2\)</span>, <span class="math notranslate nohighlight">\(S_f^2(1-S_H^2)\)</span>, and <span class="math notranslate nohighlight">\(S_f^2S_H^2(1-S_N^2)\)</span> can be used to fit the relaxation rate constants or the spectral densities directly in a linear fit.</p>
<p>We’ll use the results from the SDM, rather than trying to do the fits directly from the raw data.</p>
<p>We know from previously published results (Charlier et al.) that the rotational correlation time, <span class="math notranslate nohighlight">\(\tau_M\)</span>, is 4.84 ns</p>
<section id="plot-results-from-lemaster-s-approach">
<h3>Plot results from LeMaster’s Approach<a class="headerlink" href="#plot-results-from-lemaster-s-approach" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>

<span class="n">tM</span><span class="o">=</span><span class="mf">4.84e-9</span>  <span class="c1">#Rotation diffusion correlation time / s</span>

<span class="n">titles</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$1-S_f^2$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$S_f^2(1-S_H^2)$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$S_f^2S_H^2(1-S_N^2)$&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">v0H</span><span class="p">,</span><span class="n">J00</span><span class="p">,</span><span class="n">JomegaI0</span><span class="p">,</span><span class="n">Jp87omegaS0</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">v0H0</span><span class="p">,</span><span class="n">J0</span><span class="p">,</span><span class="n">JomegaI</span><span class="p">,</span><span class="n">Jp87omegaS</span><span class="p">,</span><span class="n">ax</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
    <span class="n">tH</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">v0H</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="o">+</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span>
    <span class="n">tN</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span>
        
    <span class="n">omega0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">v0H</span><span class="o">*</span><span class="n">rat</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="mf">0.87</span><span class="o">*</span><span class="n">v0H</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">]</span>  <span class="c1">#Frequencies sampled by SDM in rad/s</span>
    
    <span class="n">offset</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1">#This is the offset term, 2/5*tM/(1+omega*tM)</span>
    <span class="n">M</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">omega</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">omega0</span><span class="p">):</span>
        <span class="n">offset</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">tM</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tM</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#M@[(1-Sf2),Sf2*(1-SH2),Sf2*SH2*(1-SN2)] = [J0,JomegaN,0.87*JomegaH]</span>
        <span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">tM</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tM</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">tH</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tH</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">tM</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tM</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
              <span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">tN</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tN</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">tM</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tM</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))]</span>
    
    <span class="n">A0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">@</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">J00</span><span class="p">,</span><span class="n">JomegaI0</span><span class="p">,</span><span class="n">Jp87omegaS0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">offset</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#     A0=np.array([lsq(M,b)[&#39;x&#39;] for b in np.array([J00,JomegaI0,Jp87omegaS0]).T-offset]).T</span>
    
    <span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">A</span><span class="p">,</span><span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="n">titles</span><span class="p">)):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">is_first_row</span><span class="p">():</span>
            <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1H)$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39; = </span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
       
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8e0247abae626a2545e94c5ade8a902d968190bb9e845328a459ab8ba4ea4020.png" src="_images/8e0247abae626a2545e94c5ade8a902d968190bb9e845328a459ab8ba4ea4020.png" />
</div>
</div>
</section>
</section>
<section id="impact-analysis-of-full-data-set">
<h2>IMPACT Analysis of full data set<a class="headerlink" href="#impact-analysis-of-full-data-set" title="Link to this heading">#</a></h2>
<p>IMPACT assumes a correlation function which is a sum of several correlation times, where the sum of weights for the terms is 1. We will assume four correlation times here, such that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
C(t)&amp;=&amp;\frac25\sum\limits_{i=1}^4{A_ie^{-t/\tau_i}} \\
1&amp;=&amp;\sum\limits_{i=1}^4{A_i} \\
0&amp;\le&amp;A_i\le1
\end{eqnarray}
\end{split}\]</div>
<section id="plot-impact-amplitudes">
<h3>Plot IMPACT amplitudes<a class="headerlink" href="#plot-impact-amplitudes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#I cheated a little bit here...</span>
<span class="c1">#I took the correlation times from the detector analysis below for the middle 3 values</span>
<span class="c1">#And then manually optimized the last and put the first to just a short correlation time</span>
<span class="n">tau</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mf">9.9002036</span><span class="p">,</span><span class="o">-</span><span class="mf">9.2239323</span><span class="p">,</span><span class="o">-</span><span class="mf">8.5449795</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">])</span> <span class="c1">#Array of correlation times</span>
<span class="n">J</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">*</span><span class="n">J0</span><span class="p">,</span><span class="o">*</span><span class="n">JomegaI</span><span class="p">,</span><span class="o">*</span><span class="n">Jp87omegaS</span><span class="p">])</span> <span class="c1">#Collect all spectra densities</span>
<span class="n">norm</span><span class="o">=</span><span class="n">J</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#Use for reweighting</span>
<span class="n">omega</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">rat</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v0H0</span><span class="p">)),</span><span class="o">*</span><span class="p">(</span><span class="mf">0.87</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v0H0</span><span class="p">))])</span><span class="o">*</span><span class="mf">1e6</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="n">q</span><span class="o">=</span><span class="mi">10</span>

<span class="n">M</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tau</span><span class="p">)])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">tau0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tau</span><span class="p">):</span>
    <span class="n">M</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">tau0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">tau0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span>
    <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">q</span>  <span class="c1">#We&#39;ll use this position to enforce the sum of the Ai to 1</span>

<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tau</span><span class="p">),</span><span class="n">J</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">Jc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">X</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
    <span class="n">target</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="o">/</span><span class="n">norm</span><span class="p">),</span><span class="n">q</span><span class="p">])</span>
    <span class="n">out</span><span class="o">=</span><span class="n">lstsq</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">A</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="n">Jc</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="nd">@A</span><span class="p">[:,</span><span class="n">k</span><span class="p">])[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">norm</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tau</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">a</span><span class="p">,</span><span class="n">A0</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">A</span><span class="p">)):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$A_{&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;}$&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">.7</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\tau_{&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;=</span><span class="si">{</span><span class="n">tau</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">()):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;IMPACT analysis&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;IMPACT analysis&#39;)
</pre></div>
</div>
<img alt="_images/bc0a88ae9db28a72c660e11d9d139e2681a8d8d068e6232a6dd5d720cca0d662.png" src="_images/bc0a88ae9db28a72c660e11d9d139e2681a8d8d068e6232a6dd5d720cca0d662.png" />
</div>
</div>
</section>
<section id="plot-data-fit-resulting-from-impact-analysis">
<h3>Plot data fit resulting from IMPACT analysis<a class="headerlink" href="#plot-data-fit-resulting-from-impact-analysis" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">a</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Xc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">J</span><span class="p">,</span><span class="n">Jc</span><span class="p">)):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">k</span><span class="o">//</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">Xc</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$J(\omega)$&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Data Fit&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Data Fit&#39;)
</pre></div>
</div>
<img alt="_images/a46171e78e01921247ed9a42e5fc5dbcd55958ae7c5d305baee6ee6b7e3effb5.png" src="_images/a46171e78e01921247ed9a42e5fc5dbcd55958ae7c5d305baee6ee6b7e3effb5.png" />
</div>
</div>
</section>
</section>
<section id="one-field-detector-analysis-first-without-removing-tumbling">
<h2>One-field detector analysis, first without removing tumbling<a class="headerlink" href="#one-field-detector-analysis-first-without-removing-tumbling" title="Link to this heading">#</a></h2>
<p>Detector analysis can be performed on the total motion, which means for solution-state data, the overall tumbling is included in the detector responses. We do this analysis first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_sens</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">d</span><span class="p">,</span><span class="n">v0H</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">data600</span><span class="p">,</span><span class="n">data800</span><span class="p">,</span><span class="n">data950</span><span class="p">],</span><span class="n">v0H0</span><span class="p">,</span><span class="n">ax</span><span class="o">.</span><span class="n">T</span><span class="p">)):</span>
    <span class="c1">#When loaded, a &quot;solution-state&quot; sensitivity is loaded, and includes tumbling influence</span>
    <span class="c1">#For the initial analysis, we replace this with a sensitivity that does not consider tumbling</span>
    <span class="n">d</span><span class="o">.</span><span class="n">sens</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">fit</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fit</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_sens</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">fit</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">m</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;^{(\theta,S)}$&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.4</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.8</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">.007</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1H) = $&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/1ee9005cbacef3d7cfa94a6d103ae6594475ad1a1c5bc421a113e4a1c21726b8.png" src="_images/1ee9005cbacef3d7cfa94a6d103ae6594475ad1a1c5bc421a113e4a1c21726b8.png" />
<img alt="_images/d2178899d0dd1cbcac2b58abfa5847424e767f8cc5467a13508ef465ac080c29.png" src="_images/d2178899d0dd1cbcac2b58abfa5847424e767f8cc5467a13508ef465ac080c29.png" />
</div>
</div>
</section>
<section id="one-field-detector-analysis-including-removing-tumbling">
<h2>One-field detector analysis, including removing tumbling<a class="headerlink" href="#one-field-detector-analysis-including-removing-tumbling" title="Link to this heading">#</a></h2>
<p>We may also factor out isotropic tumbling, which is the case for sufficiently spherical molecules, so that detector responses represent only the internal motion. Note that this has a profound effect on the positioning of the detector windows, as discussed <a class="reference external" href="https://aip.scitation.org/doi/full/10.1063/1.5111081">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_sens</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,(</span><span class="n">d</span><span class="p">,</span><span class="n">v0H</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">data600</span><span class="p">,</span><span class="n">data800</span><span class="p">,</span><span class="n">data950</span><span class="p">],</span><span class="n">v0H0</span><span class="p">,</span><span class="n">ax</span><span class="o">.</span><span class="n">T</span><span class="p">)):</span>
    <span class="c1">#When loaded, a &quot;solution-state&quot; sensitivity is loaded, and includes tumbling influence</span>
    <span class="c1">#For the initial analysis, we replace this with a sensitivity that does not consider tumbling</span>
    <span class="n">d</span><span class="o">.</span><span class="n">sens</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">SolnNMR</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">fit</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fit</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">plot_rhoz</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_sens</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">fit</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">m</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;^{(\theta,S)}$&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_0(^1H) = $&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v0H</span><span class="si">}</span><span class="s1"> MHz&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/a6fb5810e64f857bb1e4b803b2e7425ac501a3d8c84fbcf42a8482f16c3b923f.png" src="_images/a6fb5810e64f857bb1e4b803b2e7425ac501a3d8c84fbcf42a8482f16c3b923f.png" />
<img alt="_images/1e9bdcec7f1b9aa59020ec9fd61c52fea57032a789fac8087829b19a042ad9d5.png" src="_images/1e9bdcec7f1b9aa59020ec9fd61c52fea57032a789fac8087829b19a042ad9d5.png" />
</div>
</div>
</section>
<section id="detector-analysis-of-full-data-set-without-removing-tumbling">
<h2>Detector Analysis of full data set without removing tumbling<a class="headerlink" href="#detector-analysis-of-full-data-set-without-removing-tumbling" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">NMR</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mf">7.9</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="n">info</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">S2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">S2std</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.01</span>
<span class="n">data</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">fit</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">plt_obj</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">plt_obj</span><span class="o">.</span><span class="n">ax</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">show_tc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/b44a4874f1d706a988e1d6a3f4bef348c3e243143840156853b306efc9ee96ed.png" src="_images/b44a4874f1d706a988e1d6a3f4bef348c3e243143840156853b306efc9ee96ed.png" />
</div>
</div>
</section>
<section id="detector-analysis-of-full-data-set-including-removing-tumbling">
<h2>Detector Analysis of full data set including removing tumbling<a class="headerlink" href="#detector-analysis-of-full-data-set-including-removing-tumbling" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zmax</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">*</span><span class="n">fit</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">=</span><span class="n">pyDR</span><span class="o">.</span><span class="n">Sens</span><span class="o">.</span><span class="n">SolnNMR</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">detect</span><span class="o">.</span><span class="n">r_auto</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">fit</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">plt_obj</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span><span class="n">errorbars</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">show_tc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Assigned sensitivity object did not equal detector sensitivities. Re-defining detector object
</pre></div>
</div>
<img alt="_images/05be12bfe1e8fbaf70124084328ea071f4051d95e6845dfe0fa0d144a179d494.png" src="_images/05be12bfe1e8fbaf70124084328ea071f4051d95e6845dfe0fa0d144a179d494.png" />
</div>
</div>
</section>
<section id="model-free-analysis">
<h2>Model Free Analysis<a class="headerlink" href="#model-free-analysis" title="Link to this heading">#</a></h2>
<p>In this analysis, we fit the internal motion of ubiquitin to a single correlation time, i.e. via the simple model free approach. Note that this is actually easier done to the results of the detector analysis rather than to the raw NMR data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyDR.Fitting.fit</span> <span class="kn">import</span> <span class="n">model_free</span>
<span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">error</span><span class="p">,</span><span class="n">dfit</span><span class="o">=</span><span class="n">model_free</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">nz</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt_obj</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">append_data</span><span class="p">(</span><span class="n">dfit</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">ax_sens</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Detector Responses back-calculated from MF vs original&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$1-S_f^2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z_f=\log(\tau_f$/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simple Model-Free Analysis of Detectors&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 of 1 iterations
</pre></div>
</div>
<img alt="_images/048042d9de120b0b27d0df4354a8d96a93c1e772f498dd8fcef1a3fc87a79c0a.png" src="_images/048042d9de120b0b27d0df4354a8d96a93c1e772f498dd8fcef1a3fc87a79c0a.png" />
<img alt="_images/3e43f3e9f774b6875adae21c9e083d13d7035fe27ec71496927fb0d78c2705db.png" src="_images/3e43f3e9f774b6875adae21c9e083d13d7035fe27ec71496927fb0d78c2705db.png" />
</div>
</div>
</section>
<section id="extended-model-free-analysis-of-full-data-set">
<h2>Extended Model-free analysis of full data set<a class="headerlink" href="#extended-model-free-analysis-of-full-data-set" title="Link to this heading">#</a></h2>
<p>Finally, we use an extended model free analyis. Note that for extended model free analysis, one would typically do a residue-specific model selection, where the number of free parameters is variable (correlation times, order parameters). We do not do that here, always fitting to 2 correlation times and two amplitudes (resulting in slightly different plots than found in Charlier et al.).</p>
<section id="plot-the-model-free-parameters">
<h3>Plot the Model Free parameters<a class="headerlink" href="#plot-the-model-free-parameters" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyDR.Fitting.fit</span> <span class="kn">import</span> <span class="n">model_free</span>
<span class="n">z</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">error</span><span class="p">,</span><span class="n">dfit</span><span class="o">=</span><span class="n">model_free</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">nz</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$1-S_f^2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z_f=\log(\tau_f$/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$S_f^2(1-S_s^2)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z_s=\log(\tau_s$/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Extended Model-Free Analysis of Detectors&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 of 4 iterations
2 of 4 iterations
3 of 4 iterations
4 of 4 iterations
</pre></div>
</div>
<img alt="_images/c4e7956f4adb6321f085467942cbe07a09bdc7f3b1156da4b5d0629f9e5abbf5.png" src="_images/c4e7956f4adb6321f085467942cbe07a09bdc7f3b1156da4b5d0629f9e5abbf5.png" />
</div>
</div>
</section>
<section id="plot-the-fit-of-the-detector-responses">
<h3>Plot the fit of the detector responses<a class="headerlink" href="#plot-the-fit-of-the-detector-responses" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt_obj</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">append_data</span><span class="p">(</span><span class="n">dfit</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">ax_sens</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Detector Responses back-calculated from MF vs original&#39;</span><span class="p">)</span>
<span class="n">plt_obj</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">([</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d875f14592987d77ea491390bcea553294e945767766c5d0329d241e5080239c.png" src="_images/d875f14592987d77ea491390bcea553294e945767766c5d0329d241e5080239c.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ch3_basic_NMR.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><font color="maroon">Chapter 3: A Basic NMR Analysis</font></p>
      </div>
    </a>
    <a class="right-next"
       href="Ch5_MDvsNMR.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><font color="maroon">Chapter 5: Comparing MD and NMR Results</font></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-plot-the-data">Load and plot the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-density-mapping">Spectral Density Mapping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-sdm-results">Plot the SDM results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lemaster-s-approach">LeMaster’s Approach</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-results-from-lemaster-s-approach">Plot results from LeMaster’s Approach</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-analysis-of-full-data-set">IMPACT Analysis of full data set</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-impact-amplitudes">Plot IMPACT amplitudes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data-fit-resulting-from-impact-analysis">Plot data fit resulting from IMPACT analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-field-detector-analysis-first-without-removing-tumbling">One-field detector analysis, first without removing tumbling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-field-detector-analysis-including-removing-tumbling">One-field detector analysis, including removing tumbling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detector-analysis-of-full-data-set-without-removing-tumbling">Detector Analysis of full data set without removing tumbling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detector-analysis-of-full-data-set-including-removing-tumbling">Detector Analysis of full data set including removing tumbling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-free-analysis">Model Free Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-model-free-analysis-of-full-data-set">Extended Model-free analysis of full data set</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-model-free-parameters">Plot the Model Free parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-fit-of-the-detector-responses">Plot the fit of the detector responses</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Albert Smith, Kai Zumpfe
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>